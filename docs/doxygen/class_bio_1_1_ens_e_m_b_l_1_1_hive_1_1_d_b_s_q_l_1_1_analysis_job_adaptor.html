<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>ensembl-hive: Bio::EnsEMBL::Hive::DBSQL::AnalysisJobAdaptor Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ensembl-hive
   &#160;<span id="projectnumber">2.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Bio::EnsEMBL::Hive::DBSQL::AnalysisJobAdaptor Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Inheritance diagram for Bio::EnsEMBL::Hive::DBSQL::AnalysisJobAdaptor:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor__inherit__graph.png" border="0" usemap="#_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor_inherit__map" alt="Inheritance graph"/></div>
<map name="_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor_inherit__map" id="_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor_inherit__map">
<area shape="rect" id="node2" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor.html" title="Bio::EnsEMBL::Hive\l::DBSQL::ObjectAdaptor" alt="" coords="22,97,188,138"/><area shape="rect" id="node3" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html" title="Bio::EnsEMBL::Hive\l::DBSQL::BaseAdaptor" alt="" coords="26,6,184,47"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Collaboration diagram for Bio::EnsEMBL::Hive::DBSQL::AnalysisJobAdaptor:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor__coll__graph.png" border="0" usemap="#_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor_coll__map" alt="Collaboration graph"/></div>
<map name="_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor_coll__map" id="_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor_coll__map">
<area shape="rect" id="node2" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor.html" title="Bio::EnsEMBL::Hive\l::DBSQL::ObjectAdaptor" alt="" coords="22,97,188,138"/><area shape="rect" id="node3" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html" title="Bio::EnsEMBL::Hive\l::DBSQL::BaseAdaptor" alt="" coords="26,6,184,47"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a0c5b6bbd627a70f5d1eb35b24b6e2d91"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a0c5b6bbd627a70f5d1eb35b24b6e2d91">default_table_name</a> ()</td></tr>
<tr class="separator:a0c5b6bbd627a70f5d1eb35b24b6e2d91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acaa839ac5ee54ada4e4e555205925592"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#acaa839ac5ee54ada4e4e555205925592">object_class</a> ()</td></tr>
<tr class="separator:acaa839ac5ee54ada4e4e555205925592"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5638f98e14c623db7787ae6da2f38cf"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#ad5638f98e14c623db7787ae6da2f38cf">default_overflow_limit</a> ()</td></tr>
<tr class="separator:ad5638f98e14c623db7787ae6da2f38cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a601af453349bdbe526fed38bcbbbe6af"><td class="memItemLeft" align="right" valign="top">public Reference&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a601af453349bdbe526fed38bcbbbe6af">store_jobs_and_adjust_counters</a> ()</td></tr>
<tr class="separator:a601af453349bdbe526fed38bcbbbe6af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad1bc73bd8052820705590bf853e34f0"><td class="memItemLeft" align="right" valign="top">public Reference&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#aad1bc73bd8052820705590bf853e34f0">fetch_all_by_analysis_id_status</a> ()</td></tr>
<tr class="separator:aad1bc73bd8052820705590bf853e34f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a171ed08ff5a07ce88413d1257093f7e5"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a171ed08ff5a07ce88413d1257093f7e5">fetch_some_by_analysis_id_limit</a> ()</td></tr>
<tr class="separator:a171ed08ff5a07ce88413d1257093f7e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a217294b6ab8e75844cb946b2a5cf600d"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a217294b6ab8e75844cb946b2a5cf600d">fetch_all_incomplete_jobs_by_role_id</a> ()</td></tr>
<tr class="separator:a217294b6ab8e75844cb946b2a5cf600d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3ffe9d373143c197120510bbd7f85d7"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#ab3ffe9d373143c197120510bbd7f85d7">fetch_by_url_query</a> ()</td></tr>
<tr class="separator:ab3ffe9d373143c197120510bbd7f85d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9f6c9d54c47acd37229db8f4b0f4e92"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#aa9f6c9d54c47acd37229db8f4b0f4e92">fetch_job_counts_hashed_by_status</a> ()</td></tr>
<tr class="separator:aa9f6c9d54c47acd37229db8f4b0f4e92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1518bf5c281727593960180483f8554b"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a1518bf5c281727593960180483f8554b">decrease_semaphore_count_for_jobid</a> ()</td></tr>
<tr class="separator:a1518bf5c281727593960180483f8554b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac693f76b13041b3709e5d6a11ac03820"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#ac693f76b13041b3709e5d6a11ac03820">increase_semaphore_count_for_jobid</a> ()</td></tr>
<tr class="separator:ac693f76b13041b3709e5d6a11ac03820"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfd7471aaf67585de5d3ed0458a1bfef"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#adfd7471aaf67585de5d3ed0458a1bfef">check_in_job</a> ()</td></tr>
<tr class="separator:adfd7471aaf67585de5d3ed0458a1bfef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67149e75208ca45c0df928213877ac53"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a67149e75208ca45c0df928213877ac53">store_out_files</a> ()</td></tr>
<tr class="separator:a67149e75208ca45c0df928213877ac53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dd834ac1243d05989bcb352021ede70"><td class="memItemLeft" align="right" valign="top">public <br class="typebreak"/>
<a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_analysis_job.html">Bio::EnsEMBL::Hive::AnalysisJob</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a4dd834ac1243d05989bcb352021ede70">reset_or_grab_job_by_dbID</a> ()</td></tr>
<tr class="separator:a4dd834ac1243d05989bcb352021ede70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07134ba4a84afd3ca1241b03a5bb7c1f"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a07134ba4a84afd3ca1241b03a5bb7c1f">grab_jobs_for_role</a> ()</td></tr>
<tr class="separator:a07134ba4a84afd3ca1241b03a5bb7c1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae132fe5a9be2622c21af73d926647528"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#ae132fe5a9be2622c21af73d926647528">release_claimed_jobs_from_role</a> ()</td></tr>
<tr class="separator:ae132fe5a9be2622c21af73d926647528"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64924639a2536d95c78f19b9beab64ee"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a64924639a2536d95c78f19b9beab64ee">release_undone_jobs_from_role</a> ()</td></tr>
<tr class="separator:a64924639a2536d95c78f19b9beab64ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a375c57130791087ff6781f4cc6cc9b9e"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a375c57130791087ff6781f4cc6cc9b9e">release_and_age_job</a> ()</td></tr>
<tr class="separator:a375c57130791087ff6781f4cc6cc9b9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64c5703becb2a1989bc85e449d961aba"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a64c5703becb2a1989bc85e449d961aba">gc_dataflow</a> ()</td></tr>
<tr class="separator:a64c5703becb2a1989bc85e449d961aba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a122b718f7e51f923fb50a1c01cb69805"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a122b718f7e51f923fb50a1c01cb69805">reset_jobs_for_analysis_id</a> ()</td></tr>
<tr class="separator:a122b718f7e51f923fb50a1c01cb69805"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9e28226315228b396483078e3823515"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#ac9e28226315228b396483078e3823515">balance_semaphores</a> ()</td></tr>
<tr class="separator:ac9e28226315228b396483078e3823515"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33703ebaa739dc4c4924cad07e2abd25"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a33703ebaa739dc4c4924cad07e2abd25">fetch_input_ids_for_job_ids</a> ()</td></tr>
<tr class="separator:a33703ebaa739dc4c4924cad07e2abd25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor.html">Bio::EnsEMBL::Hive::DBSQL::ObjectAdaptor</a></td></tr>
<tr class="memitem:a834186b707376a4ead29771860ab440f inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor.html#a834186b707376a4ead29771860ab440f">object_class</a> ()</td></tr>
<tr class="separator:a834186b707376a4ead29771860ab440f inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1b4e5cdd9865d10338aafe4c6d047c0 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor.html#af1b4e5cdd9865d10338aafe4c6d047c0">slicer</a> ()</td></tr>
<tr class="separator:af1b4e5cdd9865d10338aafe4c6d047c0 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02d847dd4df770edb4bdbc5ed309a2d5 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor.html#a02d847dd4df770edb4bdbc5ed309a2d5">objectify</a> ()</td></tr>
<tr class="separator:a02d847dd4df770edb4bdbc5ed309a2d5 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee5049447ae13e0e4f41a1843899c4a0 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor.html#aee5049447ae13e0e4f41a1843899c4a0">mark_stored</a> ()</td></tr>
<tr class="separator:aee5049447ae13e0e4f41a1843899c4a0 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f35b58ded43bc5407abbadff77ba767 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor.html#a2f35b58ded43bc5407abbadff77ba767">keys_to_columns</a> ()</td></tr>
<tr class="separator:a2f35b58ded43bc5407abbadff77ba767 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html">Bio::EnsEMBL::Hive::DBSQL::BaseAdaptor</a></td></tr>
<tr class="memitem:ae3e95ef6cee275aa2ace188e45da854a inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#ae3e95ef6cee275aa2ace188e45da854a">default_table_name</a> ()</td></tr>
<tr class="separator:ae3e95ef6cee275aa2ace188e45da854a inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a129b813103eead72607723d43d3a6567 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a129b813103eead72607723d43d3a6567">default_insertion_method</a> ()</td></tr>
<tr class="separator:a129b813103eead72607723d43d3a6567 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac73267d0e33aad126c188108f7e7c468 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#ac73267d0e33aad126c188108f7e7c468">default_overflow_limit</a> ()</td></tr>
<tr class="separator:ac73267d0e33aad126c188108f7e7c468 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f77cbefb20d4b4e3a40cf75ce420036 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a2f77cbefb20d4b4e3a40cf75ce420036">default_input_column_mapping</a> ()</td></tr>
<tr class="separator:a2f77cbefb20d4b4e3a40cf75ce420036 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac927d7b53cdbc9497b9dd501cbfa5cc1 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#ac927d7b53cdbc9497b9dd501cbfa5cc1">new</a> ()</td></tr>
<tr class="separator:ac927d7b53cdbc9497b9dd501cbfa5cc1 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a020d1ee154f436e472e855e746b5467d inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a020d1ee154f436e472e855e746b5467d">db</a> ()</td></tr>
<tr class="separator:a020d1ee154f436e472e855e746b5467d inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab42653d3d95c97a097fba3f8bdf8f686 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#ab42653d3d95c97a097fba3f8bdf8f686">dbc</a> ()</td></tr>
<tr class="separator:ab42653d3d95c97a097fba3f8bdf8f686 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11ea3558241f01697cdb23d27fd7b97d inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a11ea3558241f01697cdb23d27fd7b97d">prepare</a> ()</td></tr>
<tr class="separator:a11ea3558241f01697cdb23d27fd7b97d inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f8bbd7bad6d23b679d4c07ab4121085 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a1f8bbd7bad6d23b679d4c07ab4121085">overflow_limit</a> ()</td></tr>
<tr class="separator:a1f8bbd7bad6d23b679d4c07ab4121085 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7e056384281180e1b314889fc7c317f inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#ac7e056384281180e1b314889fc7c317f">input_column_mapping</a> ()</td></tr>
<tr class="separator:ac7e056384281180e1b314889fc7c317f inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ee7f9cfe42ad4993d0b544acfb4e1f5 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a9ee7f9cfe42ad4993d0b544acfb4e1f5">table_name</a> ()</td></tr>
<tr class="separator:a9ee7f9cfe42ad4993d0b544acfb4e1f5 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd1bde351fcbdfddf8fa9896c8716514 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#acd1bde351fcbdfddf8fa9896c8716514">insertion_method</a> ()</td></tr>
<tr class="separator:acd1bde351fcbdfddf8fa9896c8716514 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada55ab8c29c95535953efb0ca8c1d805 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#ada55ab8c29c95535953efb0ca8c1d805">column_set</a> ()</td></tr>
<tr class="separator:ada55ab8c29c95535953efb0ca8c1d805 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae98ea2fa8c6a85c6df918b9816bd6cbf inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#ae98ea2fa8c6a85c6df918b9816bd6cbf">primary_key</a> ()</td></tr>
<tr class="separator:ae98ea2fa8c6a85c6df918b9816bd6cbf inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae47ff32866fc8b69d8463680b5ead1d2 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#ae47ff32866fc8b69d8463680b5ead1d2">updatable_column_list</a> ()</td></tr>
<tr class="separator:ae47ff32866fc8b69d8463680b5ead1d2 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7da3298fc1c03c9e7e07123fb710e9a5 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a7da3298fc1c03c9e7e07123fb710e9a5">autoinc_id</a> ()</td></tr>
<tr class="separator:a7da3298fc1c03c9e7e07123fb710e9a5 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a348c46fdc789f2eb970dfcc5260aaa28 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">protected&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a348c46fdc789f2eb970dfcc5260aaa28">_table_info_loader</a> ()</td></tr>
<tr class="separator:a348c46fdc789f2eb970dfcc5260aaa28 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5675f57702aa4cae6bfc1e39eb420bde inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a5675f57702aa4cae6bfc1e39eb420bde">count_all</a> ()</td></tr>
<tr class="separator:a5675f57702aa4cae6bfc1e39eb420bde inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18c6bfae797d67669e16242c2390c379 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a18c6bfae797d67669e16242c2390c379">fetch_all</a> ()</td></tr>
<tr class="separator:a18c6bfae797d67669e16242c2390c379 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadc8dac52ad2c57bff954060d60af436 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#aadc8dac52ad2c57bff954060d60af436">primary_key_constraint</a> ()</td></tr>
<tr class="separator:aadc8dac52ad2c57bff954060d60af436 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29854e14eb6854bc6871db82fdb89d1f inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a29854e14eb6854bc6871db82fdb89d1f">fetch_by_dbID</a> ()</td></tr>
<tr class="separator:a29854e14eb6854bc6871db82fdb89d1f inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e7b244d27dcc1244453f725d81d3e54 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a1e7b244d27dcc1244453f725d81d3e54">remove_all</a> ()</td></tr>
<tr class="separator:a1e7b244d27dcc1244453f725d81d3e54 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab19a4a6d447c8661574a97ae159234f3 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#ab19a4a6d447c8661574a97ae159234f3">remove</a> ()</td></tr>
<tr class="separator:ab19a4a6d447c8661574a97ae159234f3 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8f4cc3813b7d1ad259b02e4a24112f2 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#ab8f4cc3813b7d1ad259b02e4a24112f2">update</a> ()</td></tr>
<tr class="separator:ab8f4cc3813b7d1ad259b02e4a24112f2 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb53e1aa4f1aed27c5b36fe626c31d81 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#adb53e1aa4f1aed27c5b36fe626c31d81">store_or_update_one</a> ()</td></tr>
<tr class="separator:adb53e1aa4f1aed27c5b36fe626c31d81 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9917d2a0731228741f098beed4ad11e1 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a9917d2a0731228741f098beed4ad11e1">check_object_present_in_db_by_content</a> ()</td></tr>
<tr class="separator:a9917d2a0731228741f098beed4ad11e1 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23e67bcbf6294126212da34c0c5a2a90 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a23e67bcbf6294126212da34c0c5a2a90">store</a> ()</td></tr>
<tr class="separator:a23e67bcbf6294126212da34c0c5a2a90 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeac6bf08072f89a153165ea39b8ed7a1 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#aeac6bf08072f89a153165ea39b8ed7a1">DESTROY</a> ()</td></tr>
<tr class="separator:aeac6bf08072f89a153165ea39b8ed7a1 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4805f85a21ec6b85814f32312ee36711 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a4805f85a21ec6b85814f32312ee36711">AUTOLOAD</a> ()</td></tr>
<tr class="separator:a4805f85a21ec6b85814f32312ee36711 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h1><a class="anchor" id="Synopsis"></a>
Synopsis</h1>
<div class="fragment"><div class="line">$analysisJobAdaptor = $db_adaptor-&gt;get_AnalysisJobAdaptor;</div>
<div class="line">$analysisJobAdaptor = $analysisJob-&gt;adaptor;</div>
</div><!-- fragment --> <h1><a class="anchor" id="Description"></a>
Description</h1>
 <pre>
    Module to encapsulate all db access for persistent class AnalysisJob.
    There should be just one per application and database connection.

</pre> </div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ac9e28226315228b396483078e3823515"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::DBSQL::AnalysisJobAdaptor::balance_semaphores </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre>
  Description: Reset all semaphore_counts to the numbers of unDONE semaphoring jobs.</pre><pre> </pre><div id="codesection-balance_semaphores" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-balance_semaphores-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-balance_semaphores-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-balance_semaphores-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#ac9e28226315228b396483078e3823515">balance_semaphores</a> {</div>
<div class="line">    my ($self, $list_of_analyses) = @_;</div>
<div class="line"></div>
<div class="line">    my $analysis_filter = $list_of_analyses</div>
<div class="line">        ? <span class="stringliteral">&quot;funnel.analysis_id IN (&quot;</span>.join(<span class="charliteral">&#39;,&#39;</span>, map { $_-&gt;dbID } @$list_of_analyses).<span class="stringliteral">&quot;) AND&quot;</span></div>
<div class="line">        : <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"></div>
<div class="line">    my $find_sql    = qq{</div>
<div class="line">                        SELECT * FROM (</div>
<div class="line">                            SELECT funnel.job_id, funnel.semaphore_count AS was, COALESCE(COUNT(CASE WHEN fan.status!=<span class="stringliteral">&#39;DONE&#39;</span> AND fan.status!=<span class="stringliteral">&#39;PASSED_ON&#39;</span> THEN 1 ELSE NULL END),0) AS should</div>
<div class="line">                            FROM job funnel</div>
<div class="line">                            LEFT JOIN job fan ON (funnel.job_id=fan.semaphored_job_id)</div>
<div class="line">                            WHERE $analysis_filter</div>
<div class="line">                            funnel.status in (<span class="stringliteral">&#39;SEMAPHORED&#39;</span>, <span class="stringliteral">&#39;READY&#39;</span>)</div>
<div class="line">                            GROUP BY funnel.job_id</div>
<div class="line">                         ) AS <span class="keyword">internal</span> WHERE was&lt;&gt;should OR should=0</div>
<div class="line">                     };</div>
<div class="line"></div>
<div class="line">    my $update_sql  = <span class="stringliteral">&quot;UPDATE job SET &quot;</span></div>
<div class="line">        .<span class="stringliteral">&quot; semaphore_count=semaphore_count+? , &quot;</span></div>
<div class="line">        .( ($self-&gt;dbc-&gt;driver eq <span class="stringliteral">&#39;pgsql&#39;</span>)</div>
<div class="line">        ? <span class="stringliteral">&quot;status = CAST(CASE WHEN semaphore_count&gt;0 THEN &#39;SEMAPHORED&#39; ELSE &#39;READY&#39; END AS jw_status) &quot;</span></div>
<div class="line">        : <span class="stringliteral">&quot;status =      CASE WHEN semaphore_count&gt;0 THEN &#39;SEMAPHORED&#39; ELSE &#39;READY&#39; END &quot;</span></div>
<div class="line">        ).<span class="stringliteral">&quot; WHERE job_id=? AND status IN (&#39;SEMAPHORED&#39;, &#39;READY&#39;)&quot;</span>;</div>
<div class="line"></div>
<div class="line">    my $find_sth    = $self-&gt;prepare($find_sql);</div>
<div class="line">    my $update_sth  = $self-&gt;prepare($update_sql);</div>
<div class="line"></div>
<div class="line">    my $rebalanced_jobs_counter = 0;</div>
<div class="line"></div>
<div class="line">    $find_sth-&gt;execute();</div>
<div class="line">    <span class="keywordflow">while</span>(my ($job_id, $was, $should) = $find_sth-&gt;fetchrow_array()) {</div>
<div class="line">        my $msg;</div>
<div class="line">        <span class="keywordflow">if</span>(0&lt;$should and $should&lt;$was) {    # we choose not to lower the counter <span class="keywordflow">if</span> it<span class="stringliteral">&#39;s not time to unblock yet</span></div>
<div class="line"><span class="stringliteral">            $msg = &quot;Semaphore count may need rebalancing, but it is not critical now, so leaving it on automatic: $was -&gt; $should&quot;;</span></div>
<div class="line"><span class="stringliteral">            $self-&gt;db-&gt;get_LogMessageAdaptor-&gt;store_job_message( $job_id, $msg, 0 );</span></div>
<div class="line"><span class="stringliteral">        } else {</span></div>
<div class="line"><span class="stringliteral">            $update_sth-&gt;execute($should-$was, $job_id);</span></div>
<div class="line"><span class="stringliteral">            $msg = &quot;Semaphore count needed rebalancing now, so performing: $was -&gt; $should&quot;;</span></div>
<div class="line"><span class="stringliteral">            $self-&gt;db-&gt;get_LogMessageAdaptor-&gt;store_job_message( $job_id, $msg, 1 );</span></div>
<div class="line"><span class="stringliteral">            $rebalanced_jobs_counter++;</span></div>
<div class="line"><span class="stringliteral">        }</span></div>
<div class="line"><span class="stringliteral">        warn &quot;[Job $job_id] $msg\n&quot;;    # TODO: integrate the STDERR diagnostic output with LogMessageAdaptor calls in general</span></div>
<div class="line"><span class="stringliteral">    }</span></div>
<div class="line"><span class="stringliteral">    $find_sth-&gt;finish;</span></div>
<div class="line"><span class="stringliteral">    $update_sth-&gt;finish;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">    return $rebalanced_jobs_counter;</span></div>
<div class="line"><span class="stringliteral">}</span></div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="adfd7471aaf67585de5d3ed0458a1bfef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::DBSQL::AnalysisJobAdaptor::check_in_job </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre>
  Arg [1]    : $analysis_id
  Example    :</pre><div class="fragment"></div><!-- fragment --> <pre>  Description: updates the job.status in the database
  Returntype : 
  Exceptions :
  Caller     : general</pre><pre> </pre><div id="codesection-check_in_job" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-check_in_job-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-check_in_job-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-check_in_job-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#adfd7471aaf67585de5d3ed0458a1bfef">check_in_job</a> {</div>
<div class="line">    my ($self, $job) = @_;</div>
<div class="line"></div>
<div class="line">    my $job_id = $job-&gt;dbID;</div>
<div class="line"></div>
<div class="line">    my $sql = <span class="stringliteral">&quot;UPDATE job SET status=&#39;&quot;</span>.$job-&gt;status.<span class="stringliteral">&quot;&#39; &quot;</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>($job-&gt;status eq <span class="stringliteral">&#39;DONE&#39;</span>) {</div>
<div class="line">        $sql .= <span class="stringliteral">&quot;,when_completed=CURRENT_TIMESTAMP&quot;</span>;</div>
<div class="line">        $sql .= <span class="stringliteral">&quot;,runtime_msec=&quot;</span>.$job-&gt;runtime_msec;</div>
<div class="line">        $sql .= <span class="stringliteral">&quot;,query_count=&quot;</span>.$job-&gt;query_count;</div>
<div class="line">    } elsif($job-&gt;status eq <span class="stringliteral">&#39;PASSED_ON&#39;</span>) {</div>
<div class="line">        $sql .= <span class="stringliteral">&quot;, when_completed=CURRENT_TIMESTAMP&quot;</span>;</div>
<div class="line">    } elsif($job-&gt;status eq <span class="stringliteral">&#39;READY&#39;</span>) {</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    $sql .= <span class="stringliteral">&quot; WHERE job_id=&#39;$job_id&#39; &quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        # This particular query is infamous for collisions and &#39;deadlock&#39; situations; let&#39;s wait and retry:</span></div>
<div class="line"><span class="preprocessor"></span>    $self-&gt;dbc-&gt;protected_prepare_execute( [ $sql ],</div>
<div class="line">        sub { my ($after) = @_; $self-&gt;db-&gt;get_LogMessageAdaptor-&gt;store_job_message( $job_id, <span class="stringliteral">&quot;checking the job in&quot;</span>.$after, 0 ); }</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="a1518bf5c281727593960180483f8554b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::DBSQL::AnalysisJobAdaptor::decrease_semaphore_count_for_jobid </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented method</p>
<div id="codesection-decrease_semaphore_count_for_jobid" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-decrease_semaphore_count_for_jobid-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-decrease_semaphore_count_for_jobid-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-decrease_semaphore_count_for_jobid-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a1518bf5c281727593960180483f8554b">decrease_semaphore_count_for_jobid</a> {    # used in semaphore annihilation or unsuccessful creation</div>
<div class="line">    my $self  = shift @_;</div>
<div class="line">    my $jobid = shift @_ or <span class="keywordflow">return</span>;</div>
<div class="line">    my $dec   = shift @_ || 1;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        # NB: BOTH THE ORDER OF UPDATES AND EXACT WORDING IS ESSENTIAL FOR SYNCHRONOUS ATOMIC OPERATION,</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #       otherwise the same command tends to behave differently on MySQL and SQLite (at least)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #</span></div>
<div class="line"><span class="preprocessor"></span>    my $sql = <span class="stringliteral">&quot;UPDATE job &quot;</span></div>
<div class="line">        .( ($self-&gt;dbc-&gt;driver eq <span class="stringliteral">&#39;pgsql&#39;</span>)</div>
<div class="line">        ? <span class="stringliteral">&quot;SET status = CAST(CASE WHEN semaphore_count&gt;$dec THEN &#39;SEMAPHORED&#39; ELSE &#39;READY&#39; END AS jw_status), &quot;</span></div>
<div class="line">        : <span class="stringliteral">&quot;SET status =      CASE WHEN semaphore_count&gt;$dec THEN &#39;SEMAPHORED&#39; ELSE &#39;READY&#39; END, &quot;</span></div>
<div class="line">        ).qq{</div>
<div class="line">            semaphore_count=semaphore_count-?</div>
<div class="line">        WHERE job_id=? AND status=<span class="stringliteral">&#39;SEMAPHORED&#39;</span></div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    $self-&gt;dbc-&gt;protected_prepare_execute( [ $sql, $dec, $jobid ],</div>
<div class="line">        sub { my ($after) = @_; $self-&gt;db-&gt;get_LogMessageAdaptor-&gt;store_hive_message( <span class="stringliteral">&#39;decreasing semaphore_count&#39;</span>.$after, 0 ); }</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="ad5638f98e14c623db7787ae6da2f38cf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::DBSQL::AnalysisJobAdaptor::default_overflow_limit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented method</p>
<div id="codesection-default_overflow_limit" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-default_overflow_limit-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-default_overflow_limit-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-default_overflow_limit-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#ad5638f98e14c623db7787ae6da2f38cf">default_overflow_limit</a> {</div>
<div class="line">    <span class="keywordflow">return</span> {</div>
<div class="line">        <span class="stringliteral">&#39;input_id&#39;</span>          =&gt; 255,</div>
<div class="line">        <span class="stringliteral">&#39;param_id_stack&#39;</span>    =&gt;  64,</div>
<div class="line">        <span class="stringliteral">&#39;accu_id_stack&#39;</span>     =&gt;  64,</div>
<div class="line">    };</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="a0c5b6bbd627a70f5d1eb35b24b6e2d91"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::DBSQL::AnalysisJobAdaptor::default_table_name </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented method</p>
<div id="codesection-default_table_name" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-default_table_name-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-default_table_name-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-default_table_name-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a0c5b6bbd627a70f5d1eb35b24b6e2d91">default_table_name</a> {</div>
<div class="line">    <span class="keywordflow">return</span> <span class="stringliteral">&#39;job&#39;</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="aad1bc73bd8052820705590bf853e34f0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Reference Bio::EnsEMBL::Hive::DBSQL::AnalysisJobAdaptor::fetch_all_by_analysis_id_status </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre>
  Arg [1]    : (optional) listref $list_of_analyses
  Arg [2]    : (optional) string $status
  Arg [3]    : (optional) int $retry_at_least
  Example    :</pre><div class="fragment"><div class="line">$all_failed_jobs = $adaptor-&gt;fetch_all_by_analysis_id_status(undef, <span class="stringliteral">&#39;FAILED&#39;</span>);</div>
<div class="line">              $analysis_done_jobs = $adaptor-&gt;fetch_all_by_analysis_id_status( $list_of_analyses, <span class="stringliteral">&#39;DONE&#39;</span>);</div>
</div><!-- fragment --> <pre>  Description: Returns a list of all jobs filtered by given analysis_id (if specified) and given status (if specified).
  Returntype : reference to list of <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_analysis_job.html">Bio::EnsEMBL::Hive::AnalysisJob</a> objects</pre><pre> </pre><div id="codesection-fetch_all_by_analysis_id_status" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-fetch_all_by_analysis_id_status-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-fetch_all_by_analysis_id_status-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-fetch_all_by_analysis_id_status-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#aad1bc73bd8052820705590bf853e34f0">fetch_all_by_analysis_id_status</a> {</div>
<div class="line">    my ($self, $list_of_analyses, $status, $retry_count_at_least) = @_;</div>
<div class="line"></div>
<div class="line">    my @constraints = ();</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>($list_of_analyses) {</div>
<div class="line">        <span class="keywordflow">if</span>(ref($list_of_analyses) eq <span class="stringliteral">&#39;ARRAY&#39;</span>) {</div>
<div class="line">            push @constraints, <span class="stringliteral">&quot;analysis_id IN (&quot;</span>.(join(<span class="charliteral">&#39;,&#39;</span>, map {$_-&gt;dbID} @$list_of_analyses)).<span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            push @constraints, <span class="stringliteral">&quot;analysis_id=$list_of_analyses&quot;</span>; # <span class="keywordflow">for</span> compatibility with old interface</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    push @constraints, <span class="stringliteral">&quot;status=&#39;$status&#39;&quot;</span>                     <span class="keywordflow">if</span> ($status);</div>
<div class="line">    push @constraints, <span class="stringliteral">&quot;retry_count &gt;= $retry_count_at_least&quot;</span> <span class="keywordflow">if</span> ($retry_count_at_least);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;fetch_all( join(<span class="stringliteral">&quot; AND &quot;</span>, @constraints) );</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="a217294b6ab8e75844cb946b2a5cf600d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::DBSQL::AnalysisJobAdaptor::fetch_all_incomplete_jobs_by_role_id </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented method</p>
<div id="codesection-fetch_all_incomplete_jobs_by_role_id" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-fetch_all_incomplete_jobs_by_role_id-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-fetch_all_incomplete_jobs_by_role_id-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-fetch_all_incomplete_jobs_by_role_id-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a217294b6ab8e75844cb946b2a5cf600d">fetch_all_incomplete_jobs_by_role_id</a> {</div>
<div class="line">    my ($self, $role_id) = @_;</div>
<div class="line"></div>
<div class="line">    my $constraint = <span class="stringliteral">&quot;status IN (&#39;CLAIMED&#39;,&#39;PRE_CLEANUP&#39;,&#39;FETCH_INPUT&#39;,&#39;RUN&#39;,&#39;WRITE_OUTPUT&#39;,&#39;POST_CLEANUP&#39;) AND role_id=&#39;$role_id&#39;&quot;</span>;</div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;fetch_all($constraint);</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="ab3ffe9d373143c197120510bbd7f85d7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::DBSQL::AnalysisJobAdaptor::fetch_by_url_query </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented method</p>
<div id="codesection-fetch_by_url_query" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-fetch_by_url_query-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-fetch_by_url_query-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-fetch_by_url_query-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#ab3ffe9d373143c197120510bbd7f85d7">fetch_by_url_query</a> {</div>
<div class="line">    my ($self, $field_name, $field_value) = @_;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>($field_name eq <span class="stringliteral">&#39;dbID&#39;</span> and $field_value) {</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> $self-&gt;fetch_by_dbID($field_value);</div>
<div class="line"></div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"></div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="a33703ebaa739dc4c4924cad07e2abd25"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::DBSQL::AnalysisJobAdaptor::fetch_input_ids_for_job_ids </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented method</p>
<div id="codesection-fetch_input_ids_for_job_ids" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-fetch_input_ids_for_job_ids-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-fetch_input_ids_for_job_ids-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-fetch_input_ids_for_job_ids-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a33703ebaa739dc4c4924cad07e2abd25">fetch_input_ids_for_job_ids</a> {</div>
<div class="line">    my ($self, $job_ids_csv, $id_scale, $id_offset) = @_;</div>
<div class="line">    $id_scale   ||= 1;</div>
<div class="line">    $id_offset  ||= 0;</div>
<div class="line"></div>
<div class="line">    my %input_ids = ();</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>( $job_ids_csv ) {</div>
<div class="line"></div>
<div class="line">        my $sql = <span class="stringliteral">&quot;SELECT job_id, input_id FROM job WHERE job_id in ($job_ids_csv)&quot;</span>;</div>
<div class="line">        my $sth = $self-&gt;prepare( $sql );</div>
<div class="line">        $sth-&gt;execute();</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">while</span>(my ($job_id, $input_id) = $sth-&gt;fetchrow_array() ) {</div>
<div class="line">            <span class="keywordflow">if</span>($input_id =~ /^_ext(?:\w+)_data_id (\d+)$/) {</div>
<div class="line">                $input_id = $self-&gt;db-&gt;get_AnalysisDataAdaptor-&gt;fetch_by_analysis_data_id_TO_data($1);</div>
<div class="line">            }</div>
<div class="line">            $input_ids{$job_id * $id_scale + $id_offset} = $input_id;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> \%input_ids;</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="aa9f6c9d54c47acd37229db8f4b0f4e92"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::DBSQL::AnalysisJobAdaptor::fetch_job_counts_hashed_by_status </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented method</p>
<div id="codesection-fetch_job_counts_hashed_by_status" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-fetch_job_counts_hashed_by_status-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-fetch_job_counts_hashed_by_status-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-fetch_job_counts_hashed_by_status-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#aa9f6c9d54c47acd37229db8f4b0f4e92">fetch_job_counts_hashed_by_status</a> {</div>
<div class="line">    my ($self, $requested_analysis_id) = @_;</div>
<div class="line"></div>
<div class="line">    my %job_counts = ();</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        # Note: this seemingly useless dummy_analysis_id is here to force MySQL use existing index on (analysis_id, status)</span></div>
<div class="line"><span class="preprocessor"></span>    my $sql = <span class="stringliteral">&quot;SELECT analysis_id, status, count(*) FROM job WHERE analysis_id=? GROUP BY analysis_id, status&quot;</span>;</div>
<div class="line">    my $sth = $self-&gt;prepare($sql);</div>
<div class="line">    $sth-&gt;execute( $requested_analysis_id );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span> (my ($dummy_analysis_id, $status, $job_count)=$sth-&gt;fetchrow_array()) {</div>
<div class="line">        $job_counts{ $status } = $job_count;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    $sth-&gt;finish;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> \%job_counts;</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="a171ed08ff5a07ce88413d1257093f7e5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::DBSQL::AnalysisJobAdaptor::fetch_some_by_analysis_id_limit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented method</p>
<div id="codesection-fetch_some_by_analysis_id_limit" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-fetch_some_by_analysis_id_limit-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-fetch_some_by_analysis_id_limit-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-fetch_some_by_analysis_id_limit-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a171ed08ff5a07ce88413d1257093f7e5">fetch_some_by_analysis_id_limit</a> {</div>
<div class="line">    my ($self, $analysis_id, $limit) = @_;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;fetch_all( <span class="stringliteral">&quot;analysis_id = &#39;$analysis_id&#39; LIMIT $limit&quot;</span> );</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="a64c5703becb2a1989bc85e449d961aba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::DBSQL::AnalysisJobAdaptor::gc_dataflow </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre>
    Description:    perform automatic dataflow from a dead job that overused resources if a corresponding dataflow rule was provided
                    Should only be called once during garbage collection phase, when the job is definitely 'abandoned' and not being worked on.</pre><pre> </pre><div id="codesection-gc_dataflow" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-gc_dataflow-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-gc_dataflow-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-gc_dataflow-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a64c5703becb2a1989bc85e449d961aba">gc_dataflow</a> {</div>
<div class="line">    my ($self, $analysis, $job_id, $branch_name) = @_;</div>
<div class="line"></div>
<div class="line">    my $branch_code = <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_dataflow_rule_adaptor.html#a529c8c386c3e60cb1a737231775bf77c">Bio::EnsEMBL::Hive::DBSQL::DataflowRuleAdaptor::branch_name_2_code</a>($branch_name);</div>
<div class="line"></div>
<div class="line">    unless( $self-&gt;db-&gt;get_DataflowRuleAdaptor-&gt;count_all_by_from_analysis_id_AND_branch_code($analysis-&gt;dbID, $branch_code) ) {</div>
<div class="line">        <span class="keywordflow">return</span> 0;   # just <span class="keywordflow">return</span> <span class="keywordflow">if</span> no corresponding <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a64c5703becb2a1989bc85e449d961aba">gc_dataflow</a> rule has been defined</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my $job = $self-&gt;fetch_by_dbID($job_id);</div>
<div class="line">    $job-&gt;analysis( $analysis );</div>
<div class="line"></div>
<div class="line">    $job-&gt;load_parameters();    # input_id_templates still supported, however to a limited extent</div>
<div class="line"></div>
<div class="line">    $job-&gt;dataflow_output_id( $job-&gt;input_id() , $branch_name );</div>
<div class="line"></div>
<div class="line">    $job-&gt;set_and_update_status(<span class="stringliteral">&#39;PASSED_ON&#39;</span>);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        # PASSED_ON jobs are included in done_job_count</span></div>
<div class="line"><span class="preprocessor"></span>    $self-&gt;db-&gt;get_AnalysisStatsAdaptor-&gt;increment_a_counter( <span class="stringliteral">&#39;done_job_count&#39;</span>, 1, $analysis-&gt;dbID );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(my $semaphored_job_id = $job-&gt;semaphored_job_id) {</div>
<div class="line">        $self-&gt;decrease_semaphore_count_for_jobid( $semaphored_job_id );    # step-unblock the semaphore</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="a07134ba4a84afd3ca1241b03a5bb7c1f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::DBSQL::AnalysisJobAdaptor::grab_jobs_for_role </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre>
  Arg [1]           : <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_role.html">Bio::EnsEMBL::Hive::Role</a> object $role
  Arg [2]           : int $how_many_this_role
  Example: 
    my $jobs  = $job_adaptor-&gt;grab_jobs_for_role( $role, $how_many );
  Description: 
    For the specified <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_role.html">Role</a>, it will search available jobs, 
    and using the how_many_this_batch parameter, claim/fetch that
    number of jobs, and then return them.
  Returntype : 
    reference to array of <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_analysis_job.html">Bio::EnsEMBL::Hive::AnalysisJob</a> objects
  Caller     : <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_worker.html#ab6456d819b72b807884df4b49ea30492">Bio::EnsEMBL::Hive::Worker::run</a></pre><pre> </pre><div id="codesection-grab_jobs_for_role" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-grab_jobs_for_role-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-grab_jobs_for_role-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-grab_jobs_for_role-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a07134ba4a84afd3ca1241b03a5bb7c1f">grab_jobs_for_role</a> {</div>
<div class="line">    my ($self, $role, $how_many_this_batch) = @_;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> [] unless( $how_many_this_batch );</div>
<div class="line">  </div>
<div class="line">    my $analysis_id     = $role-&gt;analysis_id;</div>
<div class="line">    my $role_id         = $role-&gt;dbID;</div>
<div class="line">    my $role_rank       = $self-&gt;db-&gt;get_RoleAdaptor-&gt;get_role_rank( $role );</div>
<div class="line">    my $offset          = $how_many_this_batch * $role_rank;</div>
<div class="line"></div>
<div class="line">    my $prefix_sql = ($self-&gt;dbc-&gt;driver eq <span class="stringliteral">&#39;mysql&#39;</span>) ? qq{</div>
<div class="line">         UPDATE job j</div>
<div class="line">           JOIN (</div>
<div class="line">                            SELECT job_id</div>
<div class="line">                              FROM job</div>
<div class="line">                             WHERE analysis_id=<span class="stringliteral">&#39;$analysis_id&#39;</span></div>
<div class="line">                               AND status=<span class="stringliteral">&#39;READY&#39;</span></div>
<div class="line">    } : qq{</div>
<div class="line">         UPDATE job</div>
<div class="line">           SET role_id=<span class="stringliteral">&#39;$role_id&#39;</span>, status=<span class="stringliteral">&#39;CLAIMED&#39;</span></div>
<div class="line">         WHERE job_id in (</div>
<div class="line">                            SELECT job_id</div>
<div class="line">                              FROM job</div>
<div class="line">                             WHERE analysis_id=<span class="stringliteral">&#39;$analysis_id&#39;</span></div>
<div class="line">                               AND status=<span class="stringliteral">&#39;READY&#39;</span></div>
<div class="line">    };</div>
<div class="line">    my $virgin_sql = qq{       AND retry_count=0 };</div>
<div class="line">    my $limit_sql  = qq{     LIMIT $how_many_this_batch };</div>
<div class="line">    my $offset_sql = qq{    OFFSET $offset };</div>
<div class="line">    my $suffix_sql = ($self-&gt;dbc-&gt;driver eq <span class="stringliteral">&#39;mysql&#39;</span>) ? qq{</div>
<div class="line">                 ) as x</div>
<div class="line">         USING (job_id)</div>
<div class="line">           SET j.role_id=&#39;$role_id&#39;, j.status=&#39;CLAIMED&#39;</div>
<div class="line">         WHERE j.status=&#39;READY&#39;</div>
<div class="line">    } : qq{</div>
<div class="line">                 )</div>
<div class="line">           AND status=<span class="stringliteral">&#39;READY&#39;</span></div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line">    my $claim_count;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        # we have to be explicitly numeric here because of &#39;0E0&#39; value returned by DBI if &quot;no rows have been affected&quot;:</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">if</span>(  0 == ($claim_count = $self-&gt;dbc-&gt;protected_prepare_execute( [ $prefix_sql . $virgin_sql . $limit_sql . $offset_sql . $suffix_sql ],</div>
<div class="line">                    sub { my ($after) = @_; $self-&gt;db-&gt;get_LogMessageAdaptor-&gt;store_worker_message( $role-&gt;worker, <span class="stringliteral">&quot;grabbing a virgin batch of offset jobs&quot;</span>.$after, 0 ); }</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="ac693f76b13041b3709e5d6a11ac03820"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::DBSQL::AnalysisJobAdaptor::increase_semaphore_count_for_jobid </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented method</p>
<div id="codesection-increase_semaphore_count_for_jobid" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-increase_semaphore_count_for_jobid-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-increase_semaphore_count_for_jobid-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-increase_semaphore_count_for_jobid-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#ac693f76b13041b3709e5d6a11ac03820">increase_semaphore_count_for_jobid</a> {    # used in semaphore propagation</div>
<div class="line">    my $self  = shift @_;</div>
<div class="line">    my $jobid = shift @_ or <span class="keywordflow">return</span>;</div>
<div class="line">    my $inc   = shift @_ || 1;</div>
<div class="line"></div>
<div class="line">    my $sql = qq{</div>
<div class="line">        UPDATE job</div>
<div class="line">        SET semaphore_count=semaphore_count+?</div>
<div class="line">        WHERE job_id=?</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    $self-&gt;dbc-&gt;protected_prepare_execute( [ $sql, $inc, $jobid ],</div>
<div class="line">        sub { my ($after) = @_; $self-&gt;db-&gt;get_LogMessageAdaptor-&gt;store_hive_message( <span class="stringliteral">&#39;increasing semaphore_count&#39;</span>.$after, 0 ); }</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="acaa839ac5ee54ada4e4e555205925592"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::DBSQL::AnalysisJobAdaptor::object_class </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented method</p>
<div id="codesection-object_class" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-object_class-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-object_class-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-object_class-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#acaa839ac5ee54ada4e4e555205925592">object_class</a> {</div>
<div class="line">    <span class="keywordflow">return</span> <span class="stringliteral">&#39;Bio::EnsEMBL::Hive::AnalysisJob&#39;</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="a375c57130791087ff6781f4cc6cc9b9e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::DBSQL::AnalysisJobAdaptor::release_and_age_job </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented method</p>
<div id="codesection-release_and_age_job" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-release_and_age_job-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-release_and_age_job-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-release_and_age_job-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a375c57130791087ff6781f4cc6cc9b9e">release_and_age_job</a> {</div>
<div class="line">    my ($self, $job_id, $max_retry_count, $may_retry, $runtime_msec) = @_;</div>
<div class="line">    $may_retry ||= 0;</div>
<div class="line">    $runtime_msec = <span class="stringliteral">&quot;NULL&quot;</span> unless(defined $runtime_msec);</div>
<div class="line"><span class="preprocessor">        # NB: The order of updated fields IS important. Here we first find out the new status and then increment the retry_count:</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        # FIXME: would it be possible to retain role_id for READY jobs in order to temporarily keep track of the previous (failed) worker?</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #</span></div>
<div class="line"><span class="preprocessor"></span>    $self-&gt;dbc-&gt;do( </div>
<div class="line">        <span class="stringliteral">&quot;UPDATE job &quot;</span></div>
<div class="line">        .( ($self-&gt;dbc-&gt;driver eq <span class="stringliteral">&#39;pgsql&#39;</span>)</div>
<div class="line">            ? <span class="stringliteral">&quot;SET status = CAST(CASE WHEN $may_retry AND (retry_count&lt;$max_retry_count) THEN &#39;READY&#39; ELSE &#39;FAILED&#39; END AS jw_status), &quot;</span></div>
<div class="line">            : <span class="stringliteral">&quot;SET status =      CASE WHEN $may_retry AND (retry_count&lt;$max_retry_count) THEN &#39;READY&#39; ELSE &#39;FAILED&#39; END, &quot;</span></div>
<div class="line">         ).qq{</div>
<div class="line">               retry_count=retry_count+1,</div>
<div class="line">               runtime_msec=$runtime_msec</div>
<div class="line">         WHERE job_id=$job_id</div>
<div class="line">           AND status in (<span class="stringliteral">&#39;CLAIMED&#39;</span>,<span class="stringliteral">&#39;PRE_CLEANUP&#39;</span>,<span class="stringliteral">&#39;FETCH_INPUT&#39;</span>,<span class="stringliteral">&#39;RUN&#39;</span>,<span class="stringliteral">&#39;WRITE_OUTPUT&#39;</span>,<span class="stringliteral">&#39;POST_CLEANUP&#39;</span>)</div>
<div class="line">    } );</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        # FIXME: move the decision making completely to the API side and so avoid the potential race condition.</span></div>
<div class="line"><span class="preprocessor"></span>    my $job         = $self-&gt;fetch_by_dbID( $job_id );</div>
<div class="line"></div>
<div class="line">    $self-&gt;db-&gt;get_AnalysisStatsAdaptor-&gt;increment_a_counter( ($job-&gt;status eq <span class="stringliteral">&#39;FAILED&#39;</span>) ? <span class="stringliteral">&#39;failed_job_count&#39;</span> : <span class="stringliteral">&#39;ready_job_count&#39;</span>, 1, $job-&gt;analysis_id );</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="ae132fe5a9be2622c21af73d926647528"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::DBSQL::AnalysisJobAdaptor::release_claimed_jobs_from_role </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented method</p>
<div id="codesection-release_claimed_jobs_from_role" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-release_claimed_jobs_from_role-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-release_claimed_jobs_from_role-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-release_claimed_jobs_from_role-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#ae132fe5a9be2622c21af73d926647528">release_claimed_jobs_from_role</a> {</div>
<div class="line">    my ($self, $role) = @_;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        # previous value of role_id is not important, because that Role never had a chance to run the jobs</span></div>
<div class="line"><span class="preprocessor"></span>    my $num_released_jobs = $self-&gt;dbc-&gt;protected_prepare_execute( [ <span class="stringliteral">&quot;UPDATE job SET status=&#39;READY&#39;, role_id=NULL WHERE role_id=? AND status=&#39;CLAIMED&#39;&quot;</span>, $role-&gt;dbID ],</div>
<div class="line">        sub { my ($after) = @_; $self-&gt;db-&gt;get_LogMessageAdaptor-&gt;store_worker_message( $role-&gt;worker, <span class="stringliteral">&quot;releasing claimed jobs from role&quot;</span>.$after, 0 ); }</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="a64924639a2536d95c78f19b9beab64ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::DBSQL::AnalysisJobAdaptor::release_undone_jobs_from_role </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre>
  Arg [1]    : <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_role.html">Bio::EnsEMBL::Hive::Role</a> object
  Arg [2]    : optional message to be recorded in 'job_message' table
  Example    :</pre><div class="fragment"></div><!-- fragment --> <pre>  Description: If a <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_worker.html">Worker</a> has died some of its jobs need to be reset back to 'READY'
               so they can be rerun.
               Jobs in state CLAIMED as simply reset back to READY.
               If jobs was 'in progress' (PRE_CLEANUP, FETCH_INPUT, RUN, WRITE_OUTPUT, POST_CLEANUP) 
               the retry_count is increased and the status set back to READY.
               If the retry_count &gt;= $max_retry_count (3 by default) the job is set
               to 'FAILED' and not rerun again.
  Exceptions : $role must be defined
  Caller     : <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html">Bio::EnsEMBL::Hive::Queen</a></pre><pre> </pre><div id="codesection-release_undone_jobs_from_role" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-release_undone_jobs_from_role-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-release_undone_jobs_from_role-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-release_undone_jobs_from_role-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a64924639a2536d95c78f19b9beab64ee">release_undone_jobs_from_role</a> {</div>
<div class="line">    my ($self, $role, $msg) = @_;</div>
<div class="line"></div>
<div class="line">    my $role_id         = $role-&gt;dbID;</div>
<div class="line">    my $analysis        = $role-&gt;analysis;</div>
<div class="line">    my $max_retry_count = $analysis-&gt;max_retry_count;</div>
<div class="line">    my $worker          = $role-&gt;worker;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        #first just reset the claimed jobs, these don&#39;t need a retry_count index increment:</span></div>
<div class="line"><span class="preprocessor"></span>    $self-&gt;release_claimed_jobs_from_role( $role );</div>
<div class="line"></div>
<div class="line">    my $sth = $self-&gt;prepare( qq{</div>
<div class="line">        SELECT job_id</div>
<div class="line">          FROM job</div>
<div class="line">         WHERE role_id=<span class="stringliteral">&#39;$role_id&#39;</span></div>
<div class="line">           AND status in (<span class="stringliteral">&#39;PRE_CLEANUP&#39;</span>,<span class="stringliteral">&#39;FETCH_INPUT&#39;</span>,<span class="stringliteral">&#39;RUN&#39;</span>,<span class="stringliteral">&#39;WRITE_OUTPUT&#39;</span>,<span class="stringliteral">&#39;POST_CLEANUP&#39;</span>)</div>
<div class="line">    } );</div>
<div class="line">    $sth-&gt;execute();</div>
<div class="line"></div>
<div class="line">    my $cod = $worker-&gt;cause_of_death() || <span class="stringliteral">&#39;UNKNOWN&#39;</span>;</div>
<div class="line">    $msg ||= <span class="stringliteral">&quot;GarbageCollector: The worker died because of $cod&quot;</span>;</div>
<div class="line"></div>
<div class="line">    my $resource_overusage = ($cod eq <span class="stringliteral">&#39;MEMLIMIT&#39;</span>) || ($cod eq <span class="stringliteral">&#39;RUNLIMIT&#39;</span> and $worker-&gt;work_done()==0);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span>(my ($job_id) = $sth-&gt;fetchrow_array()) {</div>
<div class="line"></div>
<div class="line">        my $passed_on = 0;  # the flag indicating that the garbage_collection was attempted and was successful</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>( $resource_overusage ) {</div>
<div class="line">            <span class="keywordflow">if</span>($passed_on = $self-&gt;gc_dataflow( $analysis, $job_id, $cod )) {</div>
<div class="line">                $msg .= <span class="stringliteral">&#39;, performing gc_dataflow&#39;</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        unless($passed_on) {</div>
<div class="line">            <span class="keywordflow">if</span>($passed_on = $self-&gt;gc_dataflow( $analysis, $job_id, <span class="stringliteral">&#39;ANYFAILURE&#39;</span> )) {</div>
<div class="line">                $msg .= <span class="stringliteral">&quot;, performing &#39;ANYFAILURE&#39; gc_dataflow&quot;</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        $self-&gt;db()-&gt;get_LogMessageAdaptor()-&gt;store_job_message($job_id, $msg, not $passed_on );</div>
<div class="line"></div>
<div class="line">        unless($passed_on) {</div>
<div class="line">            $self-&gt;release_and_age_job( $job_id, $max_retry_count, not $resource_overusage );</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        $role-&gt;register_attempt( 0 );</div>
<div class="line">    }</div>
<div class="line">    $sth-&gt;finish();</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="a122b718f7e51f923fb50a1c01cb69805"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::DBSQL::AnalysisJobAdaptor::reset_jobs_for_analysis_id </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre>
  Arg [1]    : int $analysis_id
  Arg [2]    : bool $all (false by default)
  Description: Resets either all FAILED jobs of an analysis (default)
                or ALL jobs of an analysis to 'READY' and their retry_count to 0.
  Caller     : <a class="el" href="beekeeper_8pl.html">beekeeper.pl</a></pre><pre> </pre><div id="codesection-reset_jobs_for_analysis_id" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-reset_jobs_for_analysis_id-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-reset_jobs_for_analysis_id-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-reset_jobs_for_analysis_id-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a122b718f7e51f923fb50a1c01cb69805">reset_jobs_for_analysis_id</a> {</div>
<div class="line">    my ($self, $list_of_analyses, $input_statuses) = @_;</div>
<div class="line"></div>
<div class="line">    my $analyses_filter = ( ref($list_of_analyses) eq &#39;ARRAY&#39; )</div>
<div class="line">        ? &#39;analysis_id IN (&#39;.join(&#39;,&#39;, map { $_-&gt;dbID } @$list_of_analyses).<span class="charliteral">&#39;)&#39;</span></div>
<div class="line">        : <span class="stringliteral">&#39;analysis_id=&#39;</span>.$list_of_analyses;     # compatibility mode (to be deprecated)</div>
<div class="line"></div>
<div class="line">    my $statuses_filter = (ref($input_statuses) eq &#39;ARRAY&#39;)</div>
<div class="line">        ? &#39;AND status IN (&#39;.join(&#39;, &#39;, map { <span class="stringliteral">&quot;&#39;$_&#39;&quot;</span> } @$input_statuses).<span class="charliteral">&#39;)&#39;</span></div>
<div class="line">        : (!$input_statuses)</div>
<div class="line">            ? <span class="stringliteral">&quot;AND status=&#39;FAILED&#39;&quot;</span>             # compatibility mode (to be deprecated)</div>
<div class="line">            : <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"></div>
<div class="line">    my $sql = qq{</div>
<div class="line">            UPDATE job</div>
<div class="line">           SET retry_count = CASE WHEN (status=<span class="stringliteral">&#39;READY&#39;</span> OR status=<span class="stringliteral">&#39;CLAIMED&#39;</span>) THEN 0 ELSE 1 END,</div>
<div class="line">        }. ( ($self-&gt;<a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#ab42653d3d95c97a097fba3f8bdf8f686">dbc</a>-&gt;driver eq &#39;pgsql&#39;)</div>
<div class="line">        ? &quot;status = CAST(CASE WHEN semaphore_count&gt;0 THEN &#39;SEMAPHORED&#39; ELSE &#39;READY&#39; END AS jw_status) &quot;</div>
<div class="line">        : &quot;status =      CASE WHEN semaphore_count&gt;0 THEN &#39;SEMAPHORED&#39; ELSE &#39;READY&#39; END &quot;</div>
<div class="line">        ).&quot; WHERE &quot;.$analyses_filter</div>
<div class="line">        .&#39; &#39;. $statuses_filter;</div>
<div class="line"></div>
<div class="line">    my $sth = $self-&gt;<a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a11ea3558241f01697cdb23d27fd7b97d">prepare</a>($sql);</div>
<div class="line">    $sth-&gt;execute();</div>
<div class="line">    $sth-&gt;finish;</div>
<div class="line"></div>
<div class="line">    if( ref($list_of_analyses) eq &#39;ARRAY&#39; ) {</div>
<div class="line">        <span class="keywordflow">foreach</span> my $analysis ( @$list_of_analyses ) {</div>
<div class="line">            $self-&gt;db-&gt;get_AnalysisStatsAdaptor-&gt;update_status($analysis-&gt;dbID, <span class="stringliteral">&#39;LOADING&#39;</span>);</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        $self-&gt;db-&gt;get_AnalysisStatsAdaptor-&gt;update_status($list_of_analyses, <span class="stringliteral">&#39;LOADING&#39;</span>);   # compatibility mode (to be deprecated)</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="a4dd834ac1243d05989bcb352021ede70"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_analysis_job.html">Bio::EnsEMBL::Hive::AnalysisJob</a> Bio::EnsEMBL::Hive::DBSQL::AnalysisJobAdaptor::reset_or_grab_job_by_dbID </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre>
  Arg [1]    : int $job_id
  Arg [2]    : int $role_id (optional)
  Description: resets a job to to 'READY' (if no $role_id given) or directly to 'CLAIMED' so it can be run again, and fetches it.
               NB: Will also reset a previously 'SEMAPHORED' job to READY.
               The retry_count will be set to 1 for previously run jobs (partially or wholly) to trigger PRE_CLEANUP for them,
               but will not change retry_count if a job has never *really* started.
  Returntype : <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_analysis_job.html">Bio::EnsEMBL::Hive::AnalysisJob</a> or undef</pre><pre> </pre><div id="codesection-reset_or_grab_job_by_dbID" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-reset_or_grab_job_by_dbID-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-reset_or_grab_job_by_dbID-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-reset_or_grab_job_by_dbID-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a4dd834ac1243d05989bcb352021ede70">reset_or_grab_job_by_dbID</a> {</div>
<div class="line">    my ($self, $job_id, $role_id) = @_;</div>
<div class="line"></div>
<div class="line">    my $new_status  = $role_id ? <span class="stringliteral">&#39;CLAIMED&#39;</span> : <span class="stringliteral">&#39;READY&#39;</span>;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        # Note: the order of the fields being updated is critical!</span></div>
<div class="line"><span class="preprocessor"></span>    my $sql = qq{</div>
<div class="line">        UPDATE job</div>
<div class="line">           SET retry_count = CASE WHEN (status=<span class="stringliteral">&#39;READY&#39;</span> OR status=<span class="stringliteral">&#39;CLAIMED&#39;</span>) THEN retry_count ELSE 1 END</div>
<div class="line">             , status=?</div>
<div class="line">             , role_id=?</div>
<div class="line">         WHERE job_id=?</div>
<div class="line">    };</div>
<div class="line">    my @values = ($new_status, $role_id, $job_id);</div>
<div class="line"></div>
<div class="line">    my $sth = $self-&gt;<a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a11ea3558241f01697cdb23d27fd7b97d">prepare</a>( $sql );</div>
<div class="line">    my $return_code = $sth-&gt;execute( @values )</div>
<div class="line">        or die &quot;Could not run\n\t$sql\nwith data:\n\t(&quot;.join(&#39;,&#39;, @values).&#39;)&#39;;</div>
<div class="line">    $sth-&gt;finish;</div>
<div class="line"></div>
<div class="line">    my $job = $self-&gt;fetch_by_job_id_AND_status($job_id, $new_status) ;</div>
<div class="line"></div>
<div class="line">    return $job;</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="a601af453349bdbe526fed38bcbbbe6af"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Reference Bio::EnsEMBL::Hive::DBSQL::AnalysisJobAdaptor::store_jobs_and_adjust_counters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre>
  Arg [1]    : arrayref of <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_analysis_job.html">Bio::EnsEMBL::Hive::AnalysisJob</a> $jobs_to_store
  Arg [2]    : (optional) boolean $push_new_semaphore
  Example    :</pre><div class="fragment"><div class="line">my @output_job_ids = @{ $job_adaptor-&gt;store_jobs_and_adjust_counters( \@jobs_to_store ) };</div>
</div><!-- fragment --> <pre>  Description: Attempts to store a list of jobs, returns an arrayref of successfully stored job_ids
  Returntype : Reference to list of job_dbIDs</pre><pre> </pre><div id="codesection-store_jobs_and_adjust_counters" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-store_jobs_and_adjust_counters-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-store_jobs_and_adjust_counters-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-store_jobs_and_adjust_counters-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a601af453349bdbe526fed38bcbbbe6af">store_jobs_and_adjust_counters</a> {</div>
<div class="line">    my ($self, $jobs, $push_new_semaphore) = @_;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        # NB: our use patterns assume all jobs from the same storing batch share the same semaphored_job_id:</span></div>
<div class="line"><span class="preprocessor"></span>    my $semaphored_job_id                   = scalar(@$jobs) &amp;&amp; $jobs-&gt;[0]-&gt;semaphored_job_id();</div>
<div class="line">    my $need_to_increase_semaphore_count    = ($semaphored_job_id &amp;&amp; !$push_new_semaphore);</div>
<div class="line"></div>
<div class="line">    my @output_job_ids              = ();</div>
<div class="line">    my $failed_to_store_local_jobs  = 0;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">foreach</span> my $job (@$jobs) {</div>
<div class="line"></div>
<div class="line">        my $analysis    = $job-&gt;analysis;</div>
<div class="line">        my $job_adaptor = $analysis ? $analysis-&gt;adaptor-&gt;db-&gt;get_AnalysisJobAdaptor : $self;   # <span class="keywordflow">if</span> analysis <span class="keywordtype">object</span> is undefined, consider the job local</div>
<div class="line">        my $local_job   = $job_adaptor eq $self;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">            # avoid deadlocks when dataflowing under transactional mode (used in Ortheus Runnable for example):</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span>($need_to_increase_semaphore_count and $local_job and ($job_adaptor-&gt;dbc-&gt;driver ne <span class="stringliteral">&#39;sqlite&#39;</span>)) {</div>
<div class="line">            $job_adaptor-&gt;dbc-&gt;do( <span class="stringliteral">&quot;SELECT 1 FROM job WHERE job_id=$semaphored_job_id FOR UPDATE&quot;</span> );</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        $job-&gt;prev_job( undef ) unless( $local_job );   # <span class="keywordflow">break</span> the link with the previous job <span class="keywordflow">if</span> dataflowing across databases (current schema doesn<span class="stringliteral">&#39;t support URLs for job_ids)</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">        my ($job, $stored_this_time) = $job_adaptor-&gt;store( $job );</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">        if($stored_this_time) {</span></div>
<div class="line"><span class="stringliteral">            if($need_to_increase_semaphore_count and $local_job) {  # if we are not creating a new semaphore (where dependent jobs have already been counted),</span></div>
<div class="line"><span class="stringliteral">                                                                    # but rather propagating an existing one (same or other level), we have to up-adjust the counter</span></div>
<div class="line"><span class="stringliteral">                $self-&gt;increase_semaphore_count_for_jobid( $semaphored_job_id );</span></div>
<div class="line"><span class="stringliteral">            }</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">            unless($job_adaptor-&gt;db-&gt;hive_use_triggers()) {</span></div>
<div class="line"><span class="stringliteral">                $job_adaptor-&gt;dbc-&gt;do(qq{</span></div>
<div class="line"><span class="stringliteral">                        UPDATE analysis_stats</span></div>
<div class="line"><span class="stringliteral">                        SET total_job_count=total_job_count+1</span></div>
<div class="line"><span class="stringliteral">                    }</span></div>
<div class="line"><span class="stringliteral">                    .(($job-&gt;status eq &#39;</span>READY<span class="stringliteral">&#39;)</span></div>
<div class="line"><span class="stringliteral">                        ? &quot; ,ready_job_count=ready_job_count+1 &quot;</span></div>
<div class="line"><span class="stringliteral">                        : &quot; ,semaphored_job_count=semaphored_job_count+1 &quot;</span></div>
<div class="line"><span class="stringliteral">                    ).(($job_adaptor-&gt;dbc-&gt;driver eq &#39;</span>pgsql<span class="stringliteral">&#39;)</span></div>
<div class="line"><span class="stringliteral">                        ? &quot; ,status = CAST(CASE WHEN status!=&#39;</span>BLOCKED<span class="stringliteral">&#39; THEN &#39;</span>LOADING<span class="stringliteral">&#39; ELSE &#39;</span>BLOCKED<span class="stringliteral">&#39; END AS analysis_status) &quot;</span></div>
<div class="line"><span class="stringliteral">                        : &quot; ,status =      CASE WHEN status!=&#39;</span>BLOCKED<span class="stringliteral">&#39; THEN &#39;</span>LOADING<span class="stringliteral">&#39; ELSE &#39;</span>BLOCKED<span class="stringliteral">&#39; END &quot;</span></div>
<div class="line"><span class="stringliteral">                    ).&quot; WHERE analysis_id=&quot;.$job-&gt;analysis_id</span></div>
<div class="line"><span class="stringliteral">                );</span></div>
<div class="line"><span class="stringliteral">            }</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">            push @output_job_ids, $job-&gt;dbID();</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">        } elsif( $local_job ) {</span></div>
<div class="line"><span class="stringliteral">            $self-&gt;db-&gt;get_LogMessageAdaptor-&gt;store_hive_message( &quot;JobAdaptor failed to store the local Job( analysis_id=&quot;.$job-&gt;analysis_id.&#39;</span>, <span class="stringliteral">&#39;.$job-&gt;input_id.&quot; ), possibly due to a collision&quot;, 0 );</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">            $failed_to_store_local_jobs++;</span></div>
<div class="line"><span class="stringliteral">        }</span></div>
<div class="line"><span class="stringliteral">    }</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">        # adjust semaphore_count for jobs that failed to be stored (but have been pre-counted during funnel&#39;</span>s creation):</div>
<div class="line">    if($push_new_semaphore and $failed_to_store_local_jobs) {</div>
<div class="line">        $self-&gt;decrease_semaphore_count_for_jobid( $semaphored_job_id, $failed_to_store_local_jobs );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> \@output_job_ids;</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="a67149e75208ca45c0df928213877ac53"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::DBSQL::AnalysisJobAdaptor::store_out_files </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre>
  Arg [1]    : <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_analysis_job.html">Bio::EnsEMBL::Hive::AnalysisJob</a> $job
  Example    :</pre><div class="fragment"></div><!-- fragment --> <pre>  Description: update locations of log files, if present
  Returntype : 
  Exceptions :
  Caller     : <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_worker.html">Bio::EnsEMBL::Hive::Worker</a></pre><pre> </pre><div id="codesection-store_out_files" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-store_out_files-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-store_out_files-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-store_out_files-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html#a67149e75208ca45c0df928213877ac53">store_out_files</a> {</div>
<div class="line">    my ($self, $job) = @_;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    # FIXME: An UPSERT would be better here, but it is only promised in PostgreSQL starting from 9.5, which is not officially out yet.</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">    my $delete_sql  = <span class="stringliteral">&#39;DELETE from job_file WHERE job_id=&#39;</span> . $job-&gt;dbID . <span class="stringliteral">&#39; AND retry=&#39;</span>.$job-&gt;retry_count;</div>
<div class="line">    $self-&gt;dbc-&gt;do( $delete_sql );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>($job-&gt;stdout_file or $job-&gt;stderr_file) {</div>
<div class="line">        my $insert_sql = <span class="stringliteral">&#39;INSERT INTO job_file (job_id, retry, role_id, stdout_file, stderr_file) VALUES (?,?,?,?,?)&#39;</span>;</div>
<div class="line">        my $insert_sth = $self-&gt;dbc-&gt;prepare($insert_sql);</div>
<div class="line">        $insert_sth-&gt;execute( $job-&gt;dbID, $job-&gt;retry_count, $job-&gt;role_id, $job-&gt;stdout_file, $job-&gt;stderr_file );</div>
<div class="line">        $insert_sth-&gt;finish();</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>modules/Bio/EnsEMBL/Hive/DBSQL/<a class="el" href="_analysis_job_adaptor_8pm.html">AnalysisJobAdaptor.pm</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespace_bio.html">Bio</a></li><li class="navelem"><a class="el" href="namespace_bio_1_1_ens_e_m_b_l.html">EnsEMBL</a></li><li class="navelem"><a class="el" href="namespace_bio_1_1_ens_e_m_b_l_1_1_hive.html">Hive</a></li><li class="navelem"><a class="el" href="namespace_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l.html">DBSQL</a></li><li class="navelem"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_analysis_job_adaptor.html">AnalysisJobAdaptor</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
