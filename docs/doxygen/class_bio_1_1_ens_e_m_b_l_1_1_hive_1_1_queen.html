<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>ensembl-hive: Bio::EnsEMBL::Hive::Queen Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ensembl-hive
   &#160;<span id="projectnumber">2.4</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Bio::EnsEMBL::Hive::Queen Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Inheritance diagram for Bio::EnsEMBL::Hive::Queen:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen__inherit__graph.png" border="0" usemap="#_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen_inherit__map" alt="Inheritance graph"/></div>
<map name="_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen_inherit__map" id="_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen_inherit__map">
<area shape="rect" id="node2" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor.html" title="Bio::EnsEMBL::Hive\l::DBSQL::ObjectAdaptor" alt="" coords="5,97,171,138"/><area shape="rect" id="node3" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html" title="Bio::EnsEMBL::Hive\l::DBSQL::BaseAdaptor" alt="" coords="9,6,167,47"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Collaboration diagram for Bio::EnsEMBL::Hive::Queen:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen__coll__graph.png" border="0" usemap="#_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen_coll__map" alt="Collaboration graph"/></div>
<map name="_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen_coll__map" id="_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen_coll__map">
<area shape="rect" id="node2" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor.html" title="Bio::EnsEMBL::Hive\l::DBSQL::ObjectAdaptor" alt="" coords="5,97,171,138"/><area shape="rect" id="node3" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html" title="Bio::EnsEMBL::Hive\l::DBSQL::BaseAdaptor" alt="" coords="9,6,167,47"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a545edfa6d9aa715376d5ed7d20767755"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#a545edfa6d9aa715376d5ed7d20767755">default_table_name</a> ()</td></tr>
<tr class="separator:a545edfa6d9aa715376d5ed7d20767755"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0c7e6cbb62054c0076d73a52efe9141"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#ab0c7e6cbb62054c0076d73a52efe9141">default_insertion_method</a> ()</td></tr>
<tr class="separator:ab0c7e6cbb62054c0076d73a52efe9141"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9d2e010bf4d53356d2efde2367c5472"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#af9d2e010bf4d53356d2efde2367c5472">object_class</a> ()</td></tr>
<tr class="separator:af9d2e010bf4d53356d2efde2367c5472"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cd9baa52f9e7a2240ffb979518cfee1"><td class="memItemLeft" align="right" valign="top">public <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_worker.html">Bio::EnsEMBL::Hive::Worker</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#a9cd9baa52f9e7a2240ffb979518cfee1">create_new_worker</a> ()</td></tr>
<tr class="separator:a9cd9baa52f9e7a2240ffb979518cfee1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d40ab66d3d6d591705a85fb791a34fe"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#a7d40ab66d3d6d591705a85fb791a34fe">specialize_worker</a> ()</td></tr>
<tr class="separator:a7d40ab66d3d6d591705a85fb791a34fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dc35ff50f5375e8796f12d17b372773"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#a1dc35ff50f5375e8796f12d17b372773">register_worker_death</a> ()</td></tr>
<tr class="separator:a1dc35ff50f5375e8796f12d17b372773"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3b9b35d2f58db76a9e3205c3c2985de"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#af3b9b35d2f58db76a9e3205c3c2985de">meadow_type_2_name_2_users_of_running_workers</a> ()</td></tr>
<tr class="separator:af3b9b35d2f58db76a9e3205c3c2985de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a020be70f3da4eca961fef537e68daca6"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#a020be70f3da4eca961fef537e68daca6">check_for_dead_workers</a> ()</td></tr>
<tr class="separator:a020be70f3da4eca961fef537e68daca6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ec0da9cd78a6fc994786f65b8710a7d"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#a8ec0da9cd78a6fc994786f65b8710a7d">check_in_worker</a> ()</td></tr>
<tr class="separator:a8ec0da9cd78a6fc994786f65b8710a7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46f196406a5bd9c452a5f94361a2eebd"><td class="memItemLeft" align="right" valign="top">public void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#a46f196406a5bd9c452a5f94361a2eebd">reset_job_by_dbID_and_sync</a> ()</td></tr>
<tr class="separator:a46f196406a5bd9c452a5f94361a2eebd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47b088cb6be9493e6853b5ee0b20b522"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#a47b088cb6be9493e6853b5ee0b20b522">fetch_overdue_workers</a> ()</td></tr>
<tr class="separator:a47b088cb6be9493e6853b5ee0b20b522"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2892c256744ac4bdd4f90b9bcc238735"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#a2892c256744ac4bdd4f90b9bcc238735">synchronize_hive</a> ()</td></tr>
<tr class="separator:a2892c256744ac4bdd4f90b9bcc238735"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52679a6124cddf931f1882ed5b642259"><td class="memItemLeft" align="right" valign="top">public Boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#a52679a6124cddf931f1882ed5b642259">safe_synchronize_AnalysisStats</a> ()</td></tr>
<tr class="separator:a52679a6124cddf931f1882ed5b642259"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dc0b403e92e34e2b7e01467a05dd156"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#a3dc0b403e92e34e2b7e01467a05dd156">synchronize_AnalysisStats</a> ()</td></tr>
<tr class="separator:a3dc0b403e92e34e2b7e01467a05dd156"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48b4675ba0ad0ad6fd70183e824c6e14"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#a48b4675ba0ad0ad6fd70183e824c6e14">check_nothing_to_run_but_semaphored</a> ()</td></tr>
<tr class="separator:a48b4675ba0ad0ad6fd70183e824c6e14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc4c353dfe92ddde75dbe83c460a51b8"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#abc4c353dfe92ddde75dbe83c460a51b8">print_status_and_return_reasons_to_exit</a> ()</td></tr>
<tr class="separator:abc4c353dfe92ddde75dbe83c460a51b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4f2cf470e0b3bbe732dd50c22e4deca"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#ab4f2cf470e0b3bbe732dd50c22e4deca">register_all_workers_dead</a> ()</td></tr>
<tr class="separator:ab4f2cf470e0b3bbe732dd50c22e4deca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93a13028e6f1b781c3d178f2aab61744"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#a93a13028e6f1b781c3d178f2aab61744">interval_workers_with_unknown_usage</a> ()</td></tr>
<tr class="separator:a93a13028e6f1b781c3d178f2aab61744"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa267d5c9af7b860bca670e2561de4fd2"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#aa267d5c9af7b860bca670e2561de4fd2">store_resource_usage</a> ()</td></tr>
<tr class="separator:aa267d5c9af7b860bca670e2561de4fd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor.html">Bio::EnsEMBL::Hive::DBSQL::ObjectAdaptor</a></td></tr>
<tr class="memitem:a834186b707376a4ead29771860ab440f inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor.html#a834186b707376a4ead29771860ab440f">object_class</a> ()</td></tr>
<tr class="separator:a834186b707376a4ead29771860ab440f inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1b4e5cdd9865d10338aafe4c6d047c0 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor.html#af1b4e5cdd9865d10338aafe4c6d047c0">slicer</a> ()</td></tr>
<tr class="separator:af1b4e5cdd9865d10338aafe4c6d047c0 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02d847dd4df770edb4bdbc5ed309a2d5 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor.html#a02d847dd4df770edb4bdbc5ed309a2d5">objectify</a> ()</td></tr>
<tr class="separator:a02d847dd4df770edb4bdbc5ed309a2d5 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee5049447ae13e0e4f41a1843899c4a0 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor.html#aee5049447ae13e0e4f41a1843899c4a0">mark_stored</a> ()</td></tr>
<tr class="separator:aee5049447ae13e0e4f41a1843899c4a0 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f35b58ded43bc5407abbadff77ba767 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor.html#a2f35b58ded43bc5407abbadff77ba767">keys_to_columns</a> ()</td></tr>
<tr class="separator:a2f35b58ded43bc5407abbadff77ba767 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_object_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html">Bio::EnsEMBL::Hive::DBSQL::BaseAdaptor</a></td></tr>
<tr class="memitem:ae3e95ef6cee275aa2ace188e45da854a inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#ae3e95ef6cee275aa2ace188e45da854a">default_table_name</a> ()</td></tr>
<tr class="separator:ae3e95ef6cee275aa2ace188e45da854a inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a129b813103eead72607723d43d3a6567 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a129b813103eead72607723d43d3a6567">default_insertion_method</a> ()</td></tr>
<tr class="separator:a129b813103eead72607723d43d3a6567 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac73267d0e33aad126c188108f7e7c468 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#ac73267d0e33aad126c188108f7e7c468">default_overflow_limit</a> ()</td></tr>
<tr class="separator:ac73267d0e33aad126c188108f7e7c468 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f77cbefb20d4b4e3a40cf75ce420036 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a2f77cbefb20d4b4e3a40cf75ce420036">default_input_column_mapping</a> ()</td></tr>
<tr class="separator:a2f77cbefb20d4b4e3a40cf75ce420036 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dd48172b1890159471713c1b1dc3e24 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a6dd48172b1890159471713c1b1dc3e24">do_not_update_columns</a> ()</td></tr>
<tr class="separator:a6dd48172b1890159471713c1b1dc3e24 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac927d7b53cdbc9497b9dd501cbfa5cc1 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#ac927d7b53cdbc9497b9dd501cbfa5cc1">new</a> ()</td></tr>
<tr class="separator:ac927d7b53cdbc9497b9dd501cbfa5cc1 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a020d1ee154f436e472e855e746b5467d inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a020d1ee154f436e472e855e746b5467d">db</a> ()</td></tr>
<tr class="separator:a020d1ee154f436e472e855e746b5467d inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab42653d3d95c97a097fba3f8bdf8f686 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#ab42653d3d95c97a097fba3f8bdf8f686">dbc</a> ()</td></tr>
<tr class="separator:ab42653d3d95c97a097fba3f8bdf8f686 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11ea3558241f01697cdb23d27fd7b97d inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a11ea3558241f01697cdb23d27fd7b97d">prepare</a> ()</td></tr>
<tr class="separator:a11ea3558241f01697cdb23d27fd7b97d inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f8bbd7bad6d23b679d4c07ab4121085 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a1f8bbd7bad6d23b679d4c07ab4121085">overflow_limit</a> ()</td></tr>
<tr class="separator:a1f8bbd7bad6d23b679d4c07ab4121085 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7e056384281180e1b314889fc7c317f inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#ac7e056384281180e1b314889fc7c317f">input_column_mapping</a> ()</td></tr>
<tr class="separator:ac7e056384281180e1b314889fc7c317f inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ee7f9cfe42ad4993d0b544acfb4e1f5 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a9ee7f9cfe42ad4993d0b544acfb4e1f5">table_name</a> ()</td></tr>
<tr class="separator:a9ee7f9cfe42ad4993d0b544acfb4e1f5 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd1bde351fcbdfddf8fa9896c8716514 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#acd1bde351fcbdfddf8fa9896c8716514">insertion_method</a> ()</td></tr>
<tr class="separator:acd1bde351fcbdfddf8fa9896c8716514 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada55ab8c29c95535953efb0ca8c1d805 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#ada55ab8c29c95535953efb0ca8c1d805">column_set</a> ()</td></tr>
<tr class="separator:ada55ab8c29c95535953efb0ca8c1d805 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae98ea2fa8c6a85c6df918b9816bd6cbf inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#ae98ea2fa8c6a85c6df918b9816bd6cbf">primary_key</a> ()</td></tr>
<tr class="separator:ae98ea2fa8c6a85c6df918b9816bd6cbf inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae47ff32866fc8b69d8463680b5ead1d2 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#ae47ff32866fc8b69d8463680b5ead1d2">updatable_column_list</a> ()</td></tr>
<tr class="separator:ae47ff32866fc8b69d8463680b5ead1d2 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7da3298fc1c03c9e7e07123fb710e9a5 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a7da3298fc1c03c9e7e07123fb710e9a5">autoinc_id</a> ()</td></tr>
<tr class="separator:a7da3298fc1c03c9e7e07123fb710e9a5 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a348c46fdc789f2eb970dfcc5260aaa28 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">protected&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a348c46fdc789f2eb970dfcc5260aaa28">_table_info_loader</a> ()</td></tr>
<tr class="separator:a348c46fdc789f2eb970dfcc5260aaa28 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5675f57702aa4cae6bfc1e39eb420bde inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a5675f57702aa4cae6bfc1e39eb420bde">count_all</a> ()</td></tr>
<tr class="separator:a5675f57702aa4cae6bfc1e39eb420bde inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18c6bfae797d67669e16242c2390c379 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a18c6bfae797d67669e16242c2390c379">fetch_all</a> ()</td></tr>
<tr class="separator:a18c6bfae797d67669e16242c2390c379 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadc8dac52ad2c57bff954060d60af436 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#aadc8dac52ad2c57bff954060d60af436">primary_key_constraint</a> ()</td></tr>
<tr class="separator:aadc8dac52ad2c57bff954060d60af436 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29854e14eb6854bc6871db82fdb89d1f inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a29854e14eb6854bc6871db82fdb89d1f">fetch_by_dbID</a> ()</td></tr>
<tr class="separator:a29854e14eb6854bc6871db82fdb89d1f inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e7b244d27dcc1244453f725d81d3e54 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a1e7b244d27dcc1244453f725d81d3e54">remove_all</a> ()</td></tr>
<tr class="separator:a1e7b244d27dcc1244453f725d81d3e54 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab19a4a6d447c8661574a97ae159234f3 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#ab19a4a6d447c8661574a97ae159234f3">remove</a> ()</td></tr>
<tr class="separator:ab19a4a6d447c8661574a97ae159234f3 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8f4cc3813b7d1ad259b02e4a24112f2 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#ab8f4cc3813b7d1ad259b02e4a24112f2">update</a> ()</td></tr>
<tr class="separator:ab8f4cc3813b7d1ad259b02e4a24112f2 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb53e1aa4f1aed27c5b36fe626c31d81 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#adb53e1aa4f1aed27c5b36fe626c31d81">store_or_update_one</a> ()</td></tr>
<tr class="separator:adb53e1aa4f1aed27c5b36fe626c31d81 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9917d2a0731228741f098beed4ad11e1 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a9917d2a0731228741f098beed4ad11e1">check_object_present_in_db_by_content</a> ()</td></tr>
<tr class="separator:a9917d2a0731228741f098beed4ad11e1 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23e67bcbf6294126212da34c0c5a2a90 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a23e67bcbf6294126212da34c0c5a2a90">store</a> ()</td></tr>
<tr class="separator:a23e67bcbf6294126212da34c0c5a2a90 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeac6bf08072f89a153165ea39b8ed7a1 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#aeac6bf08072f89a153165ea39b8ed7a1">DESTROY</a> ()</td></tr>
<tr class="separator:aeac6bf08072f89a153165ea39b8ed7a1 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4805f85a21ec6b85814f32312ee36711 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memItemLeft" align="right" valign="top">public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a4805f85a21ec6b85814f32312ee36711">AUTOLOAD</a> ()</td></tr>
<tr class="separator:a4805f85a21ec6b85814f32312ee36711 inherit pub_methods_class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h1><a class="anchor" id="Description"></a>
Description</h1>
 <pre>
    The Queen of the Hive based job control system is responsible to 'birthing' the
    correct number of workers of the right type so that they can find jobs to do.
    It will also free up jobs of Workers that died unexpectantly so that other workers
    can claim them to do.

    Hive based processing is a concept based on a more controlled version
    of an autonomous agent type system.  Each worker is not told what to do
    (like a centralized control system - like the current pipeline system)
    but rather queries a central database for jobs (give me jobs).

    Each worker is linked to an analysis_id, registers its self on creation
    into the Hive, creates a RunnableDB instance of the Analysis->module,
    gets $analysis->stats->batch_size jobs from the job table, does its work,
    creates the next layer of job entries by interfacing to
    the DataflowRuleAdaptor to determine the analyses it needs to pass its
    output data to and creates jobs on the next analysis database.
    It repeats this cycle until it has lived its lifetime or until there are no
    more jobs left.
    The lifetime limit is just a safety limit to prevent these from 'infecting'
    a system.

    The Queens job is to simply birth Workers of the correct analysis_id to get the
    work down.  The only other thing the Queen does is free up jobs that were
    claimed by Workers that died unexpectantly so that other workers can take
    over the work.

    The Beekeeper is in charge of interfacing between the Queen and a compute resource
    or 'compute farm'.  Its job is to query Queens if they need any workers and to
    send the requested number of workers to open machines via the runWorker.pl script.
    It is also responsible for interfacing with the Queen to identify worker which died
    unexpectantly.

</pre> </div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a020be70f3da4eca961fef537e68daca6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::Queen::check_for_dead_workers </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented method</p>
<div id="codesection-check_for_dead_workers" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-check_for_dead_workers-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-check_for_dead_workers-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-check_for_dead_workers-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#a020be70f3da4eca961fef537e68daca6">check_for_dead_workers</a> {    # scans the whole Valley <span class="keywordflow">for</span> lost Workers (but ignores unreachable ones)</div>
<div class="line">    my ($self, $valley, $check_buried_in_haste, $bury_unkwn_workers) = @_;</div>
<div class="line"></div>
<div class="line">    my $last_few_seconds            = 5;    # FIXME: It is probably a good idea to expose <span class="keyword">this</span> parameter <span class="keywordflow">for</span> easier tuning.</div>
<div class="line"></div>
<div class="line">    warn <span class="stringliteral">&quot;GarbageCollector:\tChecking for lost Workers...\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    my $meadow_type_2_name_2_users      = $self-&gt;meadow_type_2_name_2_users_of_running_workers();</div>
<div class="line">    my %signature_and_pid_to_worker_status = ();</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span>(my ($meadow_type, $level2) = each %$meadow_type_2_name_2_users) {</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(my $meadow = $valley-&gt;available_meadow_hash-&gt;{$meadow_type}) {   # <span class="keywordflow">if</span> <span class="keyword">this</span> Valley supports $meadow_type at all...</div>
<div class="line">            <span class="keywordflow">while</span>(my ($meadow_name, $level3) = each %$level2) {</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>($meadow-&gt;cached_name eq $meadow_name) {  # and we can reach the same $meadow_name from <span class="keyword">this</span> Valley...</div>
<div class="line">                    my $meadow_users_of_interest    = [ keys %$level3 ];</div>
<div class="line">                    my $meadow_signature            = $meadow_type.<span class="charliteral">&#39;/&#39;</span>.$meadow_name;</div>
<div class="line"></div>
<div class="line">                    $signature_and_pid_to_worker_status{$meadow_signature} ||= $meadow-&gt;status_of_all_our_workers( $meadow_users_of_interest );</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my $queen_overdue_workers       = $self-&gt;fetch_overdue_workers( $last_few_seconds );    # check the workers we have not seen active during the $last_few_seconds</div>
<div class="line">    warn <span class="stringliteral">&quot;GarbageCollector:\t[Queen:] out of &quot;</span>.scalar(@$queen_overdue_workers).<span class="stringliteral">&quot; Workers that haven&#39;t checked in during the last $last_few_seconds seconds...\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    my $update_when_seen_sql = <span class="stringliteral">&quot;UPDATE worker SET when_seen=CURRENT_TIMESTAMP WHERE worker_id=?&quot;</span>;</div>
<div class="line">    my $update_when_seen_sth;</div>
<div class="line"></div>
<div class="line">    my %meadow_status_counts        = ();</div>
<div class="line">    my %mt_and_pid_to_lost_worker   = ();</div>
<div class="line">    <span class="keywordflow">foreach</span> my $worker (@$queen_overdue_workers) {</div>
<div class="line"></div>
<div class="line">        my $meadow_signature    = $worker-&gt;meadow_type.<span class="charliteral">&#39;/&#39;</span>.$worker-&gt;meadow_name;</div>
<div class="line">        <span class="keywordflow">if</span>(my $pid_to_worker_status = $signature_and_pid_to_worker_status{$meadow_signature}) {   # the whole Meadow subhash is either present or the Meadow is unreachable</div>
<div class="line"></div>
<div class="line">            my $meadow_type = $worker-&gt;meadow_type;</div>
<div class="line">            my $process_id  = $worker-&gt;process_id;</div>
<div class="line">            my $status = $pid_to_worker_status-&gt;{$process_id};</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span>($bury_unkwn_workers and ($status eq <span class="stringliteral">&#39;UNKWN&#39;</span>)) {</div>
<div class="line">                <span class="keywordflow">if</span>( my $meadow = $valley-&gt;find_available_meadow_responsible_for_worker( $worker ) ) {</div>
<div class="line">                    <span class="keywordflow">if</span>($meadow-&gt;can(<span class="stringliteral">&#39;kill_worker&#39;</span>)) {</div>
<div class="line">                        <span class="keywordflow">if</span>($worker-&gt;meadow_user eq $ENV{<span class="stringliteral">&#39;USER&#39;</span>}) {  # <span class="keywordflow">if</span> I<span class="stringliteral">&#39;m actually allowed to kill the worker...</span></div>
<div class="line"><span class="stringliteral">                            warn &quot;GarbageCollector:\tKilling/forgetting the UNKWN worker by process_id $process_id&quot;;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">                            $meadow-&gt;kill_worker($worker, 1);</span></div>
<div class="line"><span class="stringliteral">                            $status = &#39;</span><span class="stringliteral">&#39;; # make it look like LOST</span></div>
<div class="line"><span class="stringliteral">                        }</span></div>
<div class="line"><span class="stringliteral">                    }</span></div>
<div class="line"><span class="stringliteral">                }</span></div>
<div class="line"><span class="stringliteral">            }</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">            if($status) {  # can be RUN|PEND|xSUSP</span></div>
<div class="line"><span class="stringliteral">                $meadow_status_counts{$meadow_signature}{$status}++;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">                    # only prepare once at most:</span></div>
<div class="line"><span class="stringliteral">                $update_when_seen_sth ||= $self-&gt;prepare( $update_when_seen_sql );</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">                $update_when_seen_sth-&gt;execute( $worker-&gt;dbID );</span></div>
<div class="line"><span class="stringliteral">            } else {</span></div>
<div class="line"><span class="stringliteral">                $meadow_status_counts{$meadow_signature}{&#39;</span>LOST<span class="stringliteral">&#39;}++;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">                $mt_and_pid_to_lost_worker{$meadow_type}{$process_id} = $worker;</span></div>
<div class="line"><span class="stringliteral">            }</span></div>
<div class="line"><span class="stringliteral">        } else {</span></div>
<div class="line"><span class="stringliteral">            $meadow_status_counts{$meadow_signature}{&#39;</span>UNREACHABLE<span class="stringliteral">&#39;}++;   # Worker is unreachable from this Valley</span></div>
<div class="line"><span class="stringliteral">        }</span></div>
<div class="line"><span class="stringliteral">    }</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">    $update_when_seen_sth-&gt;finish() if $update_when_seen_sth;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">        # print a quick summary report:</span></div>
<div class="line"><span class="stringliteral">    while(my ($meadow_signature, $status_count) = each %meadow_status_counts) {</span></div>
<div class="line"><span class="stringliteral">        warn &quot;GarbageCollector:\t[$meadow_signature Meadow:]\t&quot;.join(&#39;</span>, <span class="stringliteral">&#39;, map { &quot;$_:$status_count-&gt;{$_}&quot; } keys %$status_count ).&quot;\n\n&quot;;</span></div>
<div class="line"><span class="stringliteral">    }</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">    while(my ($meadow_type, $pid_to_lost_worker) = each %mt_and_pid_to_lost_worker) {</span></div>
<div class="line"><span class="stringliteral">        my $this_meadow = $valley-&gt;available_meadow_hash-&gt;{$meadow_type};</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">        if(my $lost_this_meadow = scalar(keys %$pid_to_lost_worker) ) {</span></div>
<div class="line"><span class="stringliteral">            warn &quot;GarbageCollector:\tDiscovered $lost_this_meadow lost $meadow_type Workers\n&quot;;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">            my $report_entries = {};</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">            if($this_meadow-&gt;can(&#39;</span>find_out_causes<span class="stringliteral">&#39;)) {</span></div>
<div class="line"><span class="stringliteral">                die &quot;Your Meadow::$meadow_type driver now has to support get_report_entries_for_process_ids() method instead of find_out_causes(). Please update it.\n&quot;;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">            } elsif ($report_entries = $this_meadow-&gt;get_report_entries_for_process_ids( keys %$pid_to_lost_worker )) {</span></div>
<div class="line"><span class="stringliteral">                my $lost_with_known_cod = scalar( grep { $_-&gt;{&#39;</span>cause_of_death<span class="stringliteral">&#39;} } values %$report_entries);</span></div>
<div class="line"><span class="stringliteral">                warn &quot;GarbageCollector:\tFound why $lost_with_known_cod of $meadow_type Workers died\n&quot;;</span></div>
<div class="line"><span class="stringliteral">            }</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">            warn &quot;GarbageCollector:\tReleasing the jobs\n&quot;;</span></div>
<div class="line"><span class="stringliteral">            while(my ($process_id, $worker) = each %$pid_to_lost_worker) {</span></div>
<div class="line"><span class="stringliteral">                $worker-&gt;when_died(         $report_entries-&gt;{$process_id}{&#39;</span>when_died<span class="stringliteral">&#39;} );</span></div>
<div class="line"><span class="stringliteral">                $worker-&gt;cause_of_death(    $report_entries-&gt;{$process_id}{&#39;</span>cause_of_death<span class="stringliteral">&#39;} );</span></div>
<div class="line"><span class="stringliteral">                $self-&gt;register_worker_death( $worker );</span></div>
<div class="line"><span class="stringliteral">            }</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">            if( %$report_entries ) {    # use the opportunity to also store resource usage of the buried workers:</span></div>
<div class="line"><span class="stringliteral">                my $processid_2_workerid = { map { $_ =&gt; $pid_to_lost_worker-&gt;{$_}-&gt;dbID } keys %$pid_to_lost_worker };</span></div>
<div class="line"><span class="stringliteral">                $self-&gt;store_resource_usage( $report_entries, $processid_2_workerid );</span></div>
<div class="line"><span class="stringliteral">            }</span></div>
<div class="line"><span class="stringliteral">        }</span></div>
<div class="line"><span class="stringliteral">    }</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">        # the following bit is completely Meadow-agnostic and only restores database integrity:</span></div>
<div class="line"><span class="stringliteral">    if($check_buried_in_haste) {</span></div>
<div class="line"><span class="stringliteral">        warn &quot;GarbageCollector:\tChecking for Workers/Roles buried in haste...\n&quot;;</span></div>
<div class="line"><span class="stringliteral">        my $buried_in_haste_list = $self-&gt;db-&gt;get_RoleAdaptor-&gt;fetch_all_finished_roles_with_unfinished_jobs();</span></div>
<div class="line"><span class="stringliteral">        if(my $bih_number = scalar(@$buried_in_haste_list)) {</span></div>
<div class="line"><span class="stringliteral">            warn &quot;GarbageCollector:\tfound $bih_number jobs, reclaiming.\n\n&quot;;</span></div>
<div class="line"><span class="stringliteral">            if($bih_number) {</span></div>
<div class="line"><span class="stringliteral">                my $job_adaptor = $self-&gt;db-&gt;get_AnalysisJobAdaptor;</span></div>
<div class="line"><span class="stringliteral">                foreach my $role (@$buried_in_haste_list) {</span></div>
<div class="line"><span class="stringliteral">                    $job_adaptor-&gt;release_undone_jobs_from_role( $role );</span></div>
<div class="line"><span class="stringliteral">                }</span></div>
<div class="line"><span class="stringliteral">            }</span></div>
<div class="line"><span class="stringliteral">        } else {</span></div>
<div class="line"><span class="stringliteral">            warn &quot;GarbageCollector:\tfound none\n&quot;;</span></div>
<div class="line"><span class="stringliteral">        }</span></div>
<div class="line"><span class="stringliteral">    }</span></div>
<div class="line"><span class="stringliteral">}</span></div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="a8ec0da9cd78a6fc994786f65b8710a7d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::Queen::check_in_worker </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented method</p>
<div id="codesection-check_in_worker" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-check_in_worker-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-check_in_worker-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-check_in_worker-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#a8ec0da9cd78a6fc994786f65b8710a7d">check_in_worker</a> {</div>
<div class="line">    my ($self, $worker) = @_;</div>
<div class="line"></div>
<div class="line">    my $sql = <span class="stringliteral">&quot;UPDATE worker SET when_checked_in=CURRENT_TIMESTAMP, status=&#39;&quot;</span>.$worker-&gt;status.<span class="stringliteral">&quot;&#39;, work_done=&#39;&quot;</span>.$worker-&gt;work_done.<span class="stringliteral">&quot;&#39; WHERE worker_id=&#39;&quot;</span>.$worker-&gt;dbID.<span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"></div>
<div class="line">    $self-&gt;dbc-&gt;protected_prepare_execute( [ $sql ],</div>
<div class="line">        sub { my ($after) = @_; $self-&gt;db-&gt;get_LogMessageAdaptor-&gt;store_worker_message( $worker, <span class="stringliteral">&quot;check_in_worker&quot;</span>.$after, 0 ); }</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="a48b4675ba0ad0ad6fd70183e824c6e14"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::Queen::check_nothing_to_run_but_semaphored </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre>
  Arg [1]    : $list_of_analyses
  Example    :</pre><div class="fragment"><div class="line">$self-&gt;check_nothing_to_run_but_semaphored( [ $analysis_A, $analysis_B ] );</div>
</div><!-- fragment --> <pre>  Description: Counts the number of immediately runnable jobs in the given analyses.
  Exceptions : none
  Caller     : <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_scheduler.html">Scheduler</a></pre><pre> </pre><div id="codesection-check_nothing_to_run_but_semaphored" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-check_nothing_to_run_but_semaphored-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-check_nothing_to_run_but_semaphored-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-check_nothing_to_run_but_semaphored-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#a48b4675ba0ad0ad6fd70183e824c6e14">check_nothing_to_run_but_semaphored</a> {   # make sure it is run after a recent sync</div>
<div class="line">    my ($self, $list_of_analyses) = @_;</div>
<div class="line"></div>
<div class="line">    my $only_semaphored_jobs_to_run = 1;</div>
<div class="line">    my $total_semaphored_job_count  = 0;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">foreach</span> my $analysis (@$list_of_analyses) {</div>
<div class="line">        my $stats = $analysis-&gt;stats;</div>
<div class="line"></div>
<div class="line">        $only_semaphored_jobs_to_run = 0 <span class="keywordflow">if</span>( $stats-&gt;total_job_count != $stats-&gt;done_job_count + $stats-&gt;failed_job_count + $stats-&gt;semaphored_job_count );</div>
<div class="line">        $total_semaphored_job_count += $stats-&gt;semaphored_job_count;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> ( $total_semaphored_job_count &amp;&amp; $only_semaphored_jobs_to_run );</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="a9cd9baa52f9e7a2240ffb979518cfee1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_worker.html">Bio::EnsEMBL::Hive::Worker</a> Bio::EnsEMBL::Hive::Queen::create_new_worker </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre>
  Description: Creates an entry in the worker table,
               populates some non-storable attributes
               and returns a <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_worker.html">Worker</a> object based on that insert.
               This guarantees that each worker registered in this <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html">Queen</a>'s hive is properly registered.
  Returntype : <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_worker.html">Bio::EnsEMBL::Hive::Worker</a>
  Caller     : <a class="el" href="run_worker_8pl.html">runWorker.pl</a></pre><pre> </pre><div id="codesection-create_new_worker" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-create_new_worker-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-create_new_worker-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-create_new_worker-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#a9cd9baa52f9e7a2240ffb979518cfee1">create_new_worker</a> {</div>
<div class="line">    my $self    = shift @_;</div>
<div class="line">    my %flags   = @_;</div>
<div class="line"></div>
<div class="line">    my ($meadow_type, $meadow_name, $process_id, $meadow_host, $meadow_user, $resource_class_id, $resource_class_name,</div>
<div class="line">        $no_write, $debug, $worker_log_dir, $hive_log_dir, $job_limit, $life_span, $no_cleanup, $retry_throwing_jobs, $can_respecialize)</div>
<div class="line">     = @flags{qw(-meadow_type -meadow_name -process_id -meadow_host -meadow_user -resource_class_id -resource_class_name</div>
<div class="line">            -no_write -debug -worker_log_dir -hive_log_dir -job_limit -life_span -no_cleanup -retry_throwing_jobs -can_respecialize)};</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">foreach</span> my $prev_worker_incarnation (@{ $self-&gt;fetch_all( <span class="stringliteral">&quot;status!=&#39;DEAD&#39; AND meadow_type=&#39;$meadow_type&#39; AND meadow_name=&#39;$meadow_name&#39; AND process_id=&#39;$process_id&#39;&quot;</span> ) }) {</div>
<div class="line"><span class="preprocessor">            # so far &#39;RELOCATED events&#39; has been detected on LSF 9.0 in response to sending signal #99 or #100</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            # Since I don&#39;t know how to avoid them, I am trying to register them when they happen.</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            # The following snippet buries the previous incarnation of the Worker before starting a new one.</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            # FIXME: if GarabageCollector (beekeeper -dead) gets to these processes first, it will register them as DEAD/UNKNOWN.</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #       LSF 9.0 does not report &quot;rescheduling&quot; events in the output of &#39;bacct&#39;, but does mention them in &#39;bhist&#39;.</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #       So parsing &#39;bhist&#39; output would probably yield the most accurate &amp; confident registration of these events.</span></div>
<div class="line"><span class="preprocessor"></span>        $prev_worker_incarnation-&gt;<a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_worker.html#a3c525fb34ae49638bf9898949f995388">cause_of_death</a>( <span class="stringliteral">&#39;RELOCATED&#39;</span> );</div>
<div class="line">        $self-&gt;register_worker_death( $prev_worker_incarnation );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my $resource_class;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>( defined($resource_class_name) ) {</div>
<div class="line">        $resource_class = $self-&gt;db-&gt;get_ResourceClassAdaptor-&gt;fetch_by_name($resource_class_name)</div>
<div class="line">            or die <span class="stringliteral">&quot;resource_class with name=&#39;$resource_class_name&#39; could not be fetched from the database&quot;</span>;</div>
<div class="line">    } elsif( defined($resource_class_id) ) {</div>
<div class="line">        $resource_class = $self-&gt;db-&gt;get_ResourceClassAdaptor-&gt;fetch_by_dbID($resource_class_id)</div>
<div class="line">            or die <span class="stringliteral">&quot;resource_class with dbID=&#39;$resource_class_id&#39; could not be fetched from the database&quot;</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my $worker = <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_worker.html">Bio::EnsEMBL::Hive::Worker</a>-&gt;<a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_storable.html#a52efcf0d0755525a7bc059b68442c620">new</a>(</div>
<div class="line">        <span class="stringliteral">&#39;meadow_type&#39;</span>       =&gt; $meadow_type,</div>
<div class="line">        <span class="stringliteral">&#39;meadow_name&#39;</span>       =&gt; $meadow_name,</div>
<div class="line">        <span class="stringliteral">&#39;meadow_host&#39;</span>       =&gt; $meadow_host,</div>
<div class="line">        <span class="stringliteral">&#39;meadow_user&#39;</span>       =&gt; $meadow_user,</div>
<div class="line">        <span class="stringliteral">&#39;process_id&#39;</span>        =&gt; $process_id,</div>
<div class="line">        <span class="stringliteral">&#39;resource_class&#39;</span>    =&gt; $resource_class,</div>
<div class="line">    );</div>
<div class="line">    $self-&gt;store( $worker );</div>
<div class="line">    my $worker_id = $worker-&gt;<a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_storable.html#a5e5743dee1414d2c0dec45b5a5d42216">dbID</a>;</div>
<div class="line"></div>
<div class="line">    $worker = $self-&gt;fetch_by_dbID( $worker_id )    # refresh the <span class="keywordtype">object</span> to <span class="keyword">get</span> the fields initialized at SQL level (timestamps in <span class="keyword">this</span> <span class="keywordflow">case</span>)</div>
<div class="line">        or die <span class="stringliteral">&quot;Could not fetch worker with dbID=$worker_id&quot;</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>($hive_log_dir or $worker_log_dir) {</div>
<div class="line">        my $dir_revhash = dir_revhash($worker_id);</div>
<div class="line">        $worker_log_dir ||= $hive_log_dir .<span class="charliteral">&#39;/&#39;</span>. ($dir_revhash ? <span class="stringliteral">&quot;$dir_revhash/&quot;</span> : <span class="stringliteral">&#39;&#39;</span>) .<span class="stringliteral">&#39;worker_id_&#39;</span>.$worker_id;</div>
<div class="line"></div>
<div class="line">        eval {</div>
<div class="line">            make_path( $worker_log_dir );</div>
<div class="line">            1;</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="ab0c7e6cbb62054c0076d73a52efe9141"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::Queen::default_insertion_method </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented method</p>
<div id="codesection-default_insertion_method" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-default_insertion_method-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-default_insertion_method-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-default_insertion_method-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#ab0c7e6cbb62054c0076d73a52efe9141">default_insertion_method</a> {</div>
<div class="line">    <span class="keywordflow">return</span> <span class="stringliteral">&#39;INSERT&#39;</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="a545edfa6d9aa715376d5ed7d20767755"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::Queen::default_table_name </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented method</p>
<div id="codesection-default_table_name" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-default_table_name-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-default_table_name-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-default_table_name-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#a545edfa6d9aa715376d5ed7d20767755">default_table_name</a> {</div>
<div class="line">    <span class="keywordflow">return</span> <span class="stringliteral">&#39;worker&#39;</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="a47b088cb6be9493e6853b5ee0b20b522"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::Queen::fetch_overdue_workers </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented method</p>
<div id="codesection-fetch_overdue_workers" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-fetch_overdue_workers-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-fetch_overdue_workers-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-fetch_overdue_workers-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#a47b088cb6be9493e6853b5ee0b20b522">fetch_overdue_workers</a> {</div>
<div class="line">    my ($self,$overdue_secs) = @_;</div>
<div class="line"></div>
<div class="line">    $overdue_secs = 3600 unless(defined($overdue_secs));</div>
<div class="line"></div>
<div class="line">    my $constraint = <span class="stringliteral">&quot;status!=&#39;DEAD&#39; AND &quot;</span>.{</div>
<div class="line">            <span class="stringliteral">&#39;mysql&#39;</span>     =&gt;  <span class="stringliteral">&quot;(UNIX_TIMESTAMP()-UNIX_TIMESTAMP(when_checked_in)) &gt; $overdue_secs&quot;</span>,</div>
<div class="line">            <span class="stringliteral">&#39;sqlite&#39;</span>    =&gt;  <span class="stringliteral">&quot;(strftime(&#39;%s&#39;,&#39;now&#39;)-strftime(&#39;%s&#39;,when_checked_in)) &gt; $overdue_secs&quot;</span>,</div>
<div class="line">            <span class="stringliteral">&#39;pgsql&#39;</span>     =&gt;  <span class="stringliteral">&quot;EXTRACT(EPOCH FROM CURRENT_TIMESTAMP - when_checked_in) &gt; $overdue_secs&quot;</span>,</div>
<div class="line">        }-&gt;{ $self-&gt;dbc-&gt;driver };</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;fetch_all( $constraint );</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="a93a13028e6f1b781c3d178f2aab61744"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::Queen::interval_workers_with_unknown_usage </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented method</p>
<div id="codesection-interval_workers_with_unknown_usage" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-interval_workers_with_unknown_usage-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-interval_workers_with_unknown_usage-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-interval_workers_with_unknown_usage-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#a93a13028e6f1b781c3d178f2aab61744">interval_workers_with_unknown_usage</a> {</div>
<div class="line">    my $self = shift @_;</div>
<div class="line"></div>
<div class="line">    my %meadow_to_interval = ();</div>
<div class="line"></div>
<div class="line">    my $sql_times = qq{</div>
<div class="line">        SELECT meadow_type, meadow_name, min(when_born), max(when_died), count(*)</div>
<div class="line">        FROM worker w</div>
<div class="line">        LEFT JOIN worker_resource_usage u USING(worker_id)</div>
<div class="line">        WHERE u.worker_id IS NULL</div>
<div class="line">        GROUP BY meadow_type, meadow_name</div>
<div class="line">    };</div>
<div class="line">    my $sth_times = $self-&gt;<a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a11ea3558241f01697cdb23d27fd7b97d">prepare</a>( $sql_times );</div>
<div class="line">    $sth_times-&gt;execute();</div>
<div class="line">    while( my ($meadow_type, $meadow_name, $min_born, $max_died, $workers_count) = $sth_times-&gt;fetchrow_array() ) {</div>
<div class="line">        $meadow_to_interval{$meadow_type}{$meadow_name} = {</div>
<div class="line">            <span class="stringliteral">&#39;min_born&#39;</span>      =&gt; $min_born,</div>
<div class="line">            <span class="stringliteral">&#39;max_died&#39;</span>      =&gt; $max_died,</div>
<div class="line">            <span class="stringliteral">&#39;workers_count&#39;</span> =&gt; $workers_count,</div>
<div class="line">        };</div>
<div class="line">    }</div>
<div class="line">    $sth_times-&gt;finish();</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> \%meadow_to_interval;</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="af3b9b35d2f58db76a9e3205c3c2985de"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::Queen::meadow_type_2_name_2_users_of_running_workers </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented method</p>
<div id="codesection-meadow_type_2_name_2_users_of_running_workers" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-meadow_type_2_name_2_users_of_running_workers-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-meadow_type_2_name_2_users_of_running_workers-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-meadow_type_2_name_2_users_of_running_workers-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#af3b9b35d2f58db76a9e3205c3c2985de">meadow_type_2_name_2_users_of_running_workers</a> {</div>
<div class="line">    my $self = shift @_;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;count_all(<span class="stringliteral">&quot;status!=&#39;DEAD&#39;&quot;</span>, [<span class="stringliteral">&#39;meadow_type&#39;</span>, <span class="stringliteral">&#39;meadow_name&#39;</span>, <span class="stringliteral">&#39;meadow_user&#39;</span>]);</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="af9d2e010bf4d53356d2efde2367c5472"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::Queen::object_class </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented method</p>
<div id="codesection-object_class" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-object_class-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-object_class-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-object_class-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#af9d2e010bf4d53356d2efde2367c5472">object_class</a> {</div>
<div class="line">    <span class="keywordflow">return</span> <span class="stringliteral">&#39;Bio::EnsEMBL::Hive::Worker&#39;</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="abc4c353dfe92ddde75dbe83c460a51b8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::Queen::print_status_and_return_reasons_to_exit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre>
  Arg [1]    : $list_of_analyses
  Example    :</pre><div class="fragment"><div class="line">my $reasons_to_exit = $queen-&gt;print_status_and_return_reasons_to_exit( [ $analysis_A, $analysis_B ] );</div>
</div><!-- fragment --> <pre>  Description: Runs through all analyses in the given list, reports failed analyses, computes some totals, prints a combined status line
                and returns a pair of ($failed_analyses_counter, $total_jobs_to_do)
  Exceptions : none
  Caller     : <a class="el" href="beekeeper_8pl.html">beekeeper.pl</a></pre><pre> </pre><div id="codesection-print_status_and_return_reasons_to_exit" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-print_status_and_return_reasons_to_exit-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-print_status_and_return_reasons_to_exit-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-print_status_and_return_reasons_to_exit-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#abc4c353dfe92ddde75dbe83c460a51b8">print_status_and_return_reasons_to_exit</a> {</div>
<div class="line">    my ($self, $list_of_analyses) = @_;</div>
<div class="line"></div>
<div class="line">    my ($total_done_jobs, $total_failed_jobs, $total_jobs, $cpumsec_to_do) = (0) x 4;</div>
<div class="line">    my $reasons_to_exit = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"></div>
<div class="line">    my $max_logic_name_length = max(map {length($_-&gt;logic_name)} @$list_of_analyses);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">foreach</span> my $analysis (sort {$a-&gt;dbID &lt;=&gt; $b-&gt;dbID} @$list_of_analyses) {</div>
<div class="line">        my $stats               = $analysis-&gt;stats;</div>
<div class="line">        my $failed_job_count    = $stats-&gt;failed_job_count;</div>
<div class="line"></div>
<div class="line">        print $stats-&gt;toString($max_logic_name_length) . <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>( $stats-&gt;status eq <span class="stringliteral">&#39;FAILED&#39;</span>) {</div>
<div class="line">            my $logic_name    = $analysis-&gt;logic_name;</div>
<div class="line">            my $tolerance     = $analysis-&gt;failed_job_tolerance;</div>
<div class="line">            $reasons_to_exit .= <span class="stringliteral">&quot;### Analysis &#39;$logic_name&#39; has FAILED  (failed Jobs: $failed_job_count, tolerance: $tolerance\%) ###\n&quot;</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        $total_done_jobs    += $stats-&gt;done_job_count;</div>
<div class="line">        $total_failed_jobs  += $failed_job_count;</div>
<div class="line">        $total_jobs         += $stats-&gt;total_job_count;</div>
<div class="line">        $cpumsec_to_do      += $stats-&gt;ready_job_count * $stats-&gt;avg_msec_per_job;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my $total_jobs_to_do        = $total_jobs - $total_done_jobs - $total_failed_jobs;         # includes SEMAPHORED, READY, CLAIMED, INPROGRESS</div>
<div class="line">    my $cpuhrs_to_do            = $cpumsec_to_do / (1000.0*60*60);</div>
<div class="line">    my $percentage_completed    = $total_jobs</div>
<div class="line">                                    ? (($total_done_jobs+$total_failed_jobs)*100.0/$total_jobs)</div>
<div class="line">                                    : 0.0;</div>
<div class="line"></div>
<div class="line">    printf(<span class="stringliteral">&quot;total over %d analyses : %6.2f%% complete (&lt; %.2f CPU_hrs) (%d to_do + %d done + %d failed = %d total)\n&quot;</span>,</div>
<div class="line">                scalar(@$list_of_analyses), $percentage_completed, $cpuhrs_to_do, $total_jobs_to_do, $total_done_jobs, $total_failed_jobs, $total_jobs);</div>
<div class="line"></div>
<div class="line">    unless( $total_jobs_to_do ) {</div>
<div class="line">        $reasons_to_exit .= <span class="stringliteral">&quot;### No jobs left to do ###\n&quot;</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $reasons_to_exit;</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="ab4f2cf470e0b3bbe732dd50c22e4deca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::Queen::register_all_workers_dead </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre>
  Example    :</pre><div class="fragment"><div class="line">$queen-&gt;register_all_workers_dead();</div>
</div><!-- fragment --> <pre>  Description: Registers all workers dead
  Exceptions : none
  Caller     : <a class="el" href="beekeeper_8pl.html">beekeeper.pl</a></pre><pre> </pre><div id="codesection-register_all_workers_dead" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-register_all_workers_dead-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-register_all_workers_dead-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-register_all_workers_dead-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#ab4f2cf470e0b3bbe732dd50c22e4deca">register_all_workers_dead</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my $all_workers_considered_alive = $self-&gt;fetch_all( <span class="stringliteral">&quot;status!=&#39;DEAD&#39;&quot;</span> );</div>
<div class="line">    <span class="keywordflow">foreach</span> my $worker (@{$all_workers_considered_alive}) {</div>
<div class="line">        $self-&gt;register_worker_death( $worker );</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="a1dc35ff50f5375e8796f12d17b372773"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::Queen::register_worker_death </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented method</p>
<div id="codesection-register_worker_death" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-register_worker_death-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-register_worker_death-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-register_worker_death-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#a1dc35ff50f5375e8796f12d17b372773">register_worker_death</a> {</div>
<div class="line">    my ($self, $worker, $update_when_checked_in) = @_;</div>
<div class="line"></div>
<div class="line">    my $worker_id       = $worker-&gt;dbID;</div>
<div class="line">    my $work_done       = $worker-&gt;work_done;</div>
<div class="line">    my $cause_of_death  = $worker-&gt;cause_of_death || <span class="stringliteral">&#39;UNKNOWN&#39;</span>;    # make sure we <span class="keywordflow">do</span> not attempt to insert a <span class="keywordtype">void</span></div>
<div class="line">    my $worker_died     = $worker-&gt;when_died;</div>
<div class="line"></div>
<div class="line">    my $current_role    = $worker-&gt;current_role;</div>
<div class="line"></div>
<div class="line">    unless( $current_role ) {</div>
<div class="line">        $worker-&gt;current_role( $current_role = $self-&gt;db-&gt;get_RoleAdaptor-&gt;fetch_last_unfinished_by_worker_id( $worker_id ) );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>( $current_role and !$current_role-&gt;when_finished() ) {</div>
<div class="line"><span class="preprocessor">        # List of cause_of_death:</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        # only happen before or after a batch: &#39;NO_ROLE&#39;,&#39;NO_WORK&#39;,&#39;JOB_LIMIT&#39;,&#39;HIVE_OVERLOAD&#39;,&#39;LIFESPAN&#39;,&#39;SEE_MSG&#39;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        # can happen whilst the worker is running a batch: &#39;CONTAMINATED&#39;,&#39;RELOCATED&#39;,&#39;KILLED_BY_USER&#39;,&#39;MEMLIMIT&#39;,&#39;RUNLIMIT&#39;,&#39;SEE_MSG&#39;,&#39;UNKNOWN&#39;</span></div>
<div class="line"><span class="preprocessor"></span>        my $release_undone_jobs = ($cause_of_death =~ /^(CONTAMINATED|RELOCATED|KILLED_BY_USER|MEMLIMIT|RUNLIMIT|SEE_MSG|UNKNOWN)$/);</div>
<div class="line">        $current_role-&gt;worker($worker); # So that release_undone_jobs_from_role() has the correct cause_of_death and work_done</div>
<div class="line">        $current_role-&gt;when_finished( $worker_died );</div>
<div class="line">        $self-&gt;<a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#a020d1ee154f436e472e855e746b5467d">db</a>-&gt;get_RoleAdaptor-&gt;finalize_role( $current_role, $release_undone_jobs );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my $sql = &quot;UPDATE worker SET status=&#39;DEAD&#39;, work_done=&#39;$work_done&#39;, cause_of_death=&#39;$cause_of_death&#39;&quot;</div>
<div class="line">            . ( $update_when_checked_in ? &#39;, when_checked_in=CURRENT_TIMESTAMP &#39; : &#39;&#39; )</div>
<div class="line">            . ( $worker_died ? &quot;, when_died=&#39;$worker_died&#39;&quot; : &#39;, when_died=CURRENT_TIMESTAMP&#39; )</div>
<div class="line">            . &quot; WHERE worker_id=&#39;$worker_id&#39; &quot;;</div>
<div class="line"></div>
<div class="line">    $self-&gt;<a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#ab42653d3d95c97a097fba3f8bdf8f686">dbc</a>-&gt;protected_prepare_execute( [ $sql ],</div>
<div class="line">        sub { my ($after) = @_; $self-&gt;db-&gt;get_LogMessageAdaptor-&gt;store_worker_message( $worker, <span class="stringliteral">&quot;register_worker_death&quot;</span>.$after, 0 ); }</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="a46f196406a5bd9c452a5f94361a2eebd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public void Bio::EnsEMBL::Hive::Queen::reset_job_by_dbID_and_sync </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre>
  Arg [1]: int $job_id
  Example: 
    my $job = $queen-&gt;reset_job_by_dbID_and_sync($job_id);
  Description: 
    For the specified job_id it will fetch just that job, 
    reset it completely as if it has never run, and return it.  
    Specifying a specific job bypasses the safety checks, 
    thus multiple workers could be running the 
    same job simultaneously (use only for debugging).
  Returntype : none
  Exceptions :
  Caller     : <a class="el" href="beekeeper_8pl.html">beekeeper.pl</a></pre><pre> </pre><div id="codesection-reset_job_by_dbID_and_sync" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-reset_job_by_dbID_and_sync-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-reset_job_by_dbID_and_sync-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-reset_job_by_dbID_and_sync-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#a46f196406a5bd9c452a5f94361a2eebd">reset_job_by_dbID_and_sync</a> {</div>
<div class="line">    my ($self, $job_id) = @_;</div>
<div class="line"></div>
<div class="line">    my $job     = $self-&gt;db-&gt;get_AnalysisJobAdaptor-&gt;reset_or_grab_job_by_dbID($job_id);</div>
<div class="line"></div>
<div class="line">    my $stats   = $job-&gt;analysis-&gt;stats;</div>
<div class="line"></div>
<div class="line">    $self-&gt;synchronize_AnalysisStats($stats);</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="a52679a6124cddf931f1882ed5b642259"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Boolean Bio::EnsEMBL::Hive::Queen::safe_synchronize_AnalysisStats </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre>
  Arg [1]    : <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_analysis_stats.html">Bio::EnsEMBL::Hive::AnalysisStats</a> object
  Example    :</pre><div class="fragment"><div class="line">$self-&gt;safe_synchronize_AnalysisStats($stats);</div>
</div><!-- fragment --> <pre>  Description: Prewrapper around synchronize_AnalysisStats that does
               checks and grabs sync_lock before proceeding with sync.
               Used by distributed worker sync system to avoid contention.
               Returns 1 on success and 0 if the lock could not have been obtained,
               and so no sync was attempted.
  Returntype : boolean
  Caller     : general</pre><pre> </pre><div id="codesection-safe_synchronize_AnalysisStats" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-safe_synchronize_AnalysisStats-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-safe_synchronize_AnalysisStats-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-safe_synchronize_AnalysisStats-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#a52679a6124cddf931f1882ed5b642259">safe_synchronize_AnalysisStats</a> {</div>
<div class="line">    my ($self, $stats) = @_;</div>
<div class="line"></div>
<div class="line">    $stats-&gt;refresh();</div>
<div class="line"></div>
<div class="line">    my $max_refresh_attempts = 5;</div>
<div class="line">    <span class="keywordflow">while</span>($stats-&gt;sync_lock and $max_refresh_attempts--) {   # another Worker/Beekeeper is synching <span class="keyword">this</span> analysis right now</div>
<div class="line"><span class="preprocessor">            # ToDo: it would be nice to report the detected collision</span></div>
<div class="line"><span class="preprocessor"></span>        sleep(1);</div>
<div class="line">        $stats-&gt;refresh();  # just <span class="keywordflow">try</span> to avoid collision</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    unless( ($stats-&gt;status eq <span class="stringliteral">&#39;DONE&#39;</span>)</div>
<div class="line">         or ( ($stats-&gt;status eq <span class="stringliteral">&#39;WORKING&#39;</span>) and defined($stats-&gt;seconds_since_when_updated) and ($stats-&gt;seconds_since_when_updated &lt; 3*60) ) ) {</div>
<div class="line"></div>
<div class="line">        my $sql = <span class="stringliteral">&quot;UPDATE analysis_stats SET status=&#39;SYNCHING&#39;, sync_lock=1 &quot;</span>.</div>
<div class="line">                  <span class="stringliteral">&quot;WHERE sync_lock=0 and analysis_id=&quot;</span> . $stats-&gt;analysis_id;</div>
<div class="line"></div>
<div class="line">        my $row_count = $self-&gt;dbc-&gt;do($sql);   # <span class="keywordflow">try</span> to claim the sync_lock</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>( $row_count == 1 ) {     # <span class="keywordflow">if</span> we managed to obtain the lock, let<span class="stringliteral">&#39;s go and perform the sync:</span></div>
<div class="line"><span class="stringliteral">            $self-&gt;synchronize_AnalysisStats($stats);   </span></div>
<div class="line"><span class="stringliteral">            return 1;</span></div>
<div class="line"><span class="stringliteral">        } # otherwise assume it&#39;</span>s locked and just <span class="keywordflow">return</span> un-updated</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="a7d40ab66d3d6d591705a85fb791a34fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::Queen::specialize_worker </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre>
  Description: If analysis_id or logic_name is specified it will try to specialize the <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_worker.html">Worker</a> into this analysis.
               If not specified the <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html">Queen</a> will analyze the hive and pick the most suitable analysis.
  Caller     : <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_worker.html">Bio::EnsEMBL::Hive::Worker</a></pre><pre> </pre><div id="codesection-specialize_worker" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-specialize_worker-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-specialize_worker-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-specialize_worker-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#a7d40ab66d3d6d591705a85fb791a34fe">specialize_worker</a> {</div>
<div class="line">    my $self    = shift @_;</div>
<div class="line">    my $worker  = shift @_;</div>
<div class="line">    my $flags   = shift @_;</div>
<div class="line"></div>
<div class="line">    my ($analyses_pattern, $job_id, $force)</div>
<div class="line">     = @$flags{qw(-analyses_pattern -job_id -force)};</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>( $analyses_pattern and $job_id ) {</div>
<div class="line">        die <span class="stringliteral">&quot;At most one of the options {-analyses_pattern, -job_id} can be set to pre-specialize a Worker&quot;</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my $analysis;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>( $job_id ) {</div>
<div class="line"></div>
<div class="line">        warn <span class="stringliteral">&quot;resetting and fetching job for job_id &#39;$job_id&#39;\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">        my $job_adaptor = $self-&gt;db-&gt;get_AnalysisJobAdaptor;</div>
<div class="line"></div>
<div class="line">        my $job = $job_adaptor-&gt;fetch_by_dbID( $job_id )</div>
<div class="line">            or die <span class="stringliteral">&quot;Could not fetch job with dbID=&#39;$job_id&#39;&quot;</span>;</div>
<div class="line">        my $job_status = $job-&gt;status();</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>($job_status =~/(CLAIMED|PRE_CLEANUP|FETCH_INPUT|RUN|WRITE_OUTPUT|POST_CLEANUP)/ ) {</div>
<div class="line">            die <span class="stringliteral">&quot;Job with dbID=&#39;$job_id&#39; is already in progress, cannot run&quot;</span>;   # FIXME: <span class="keywordflow">try</span> GC first, then complain</div>
<div class="line">        } elsif($job_status =~/(DONE|SEMAPHORED)/ and !$force) {</div>
<div class="line">            die <span class="stringliteral">&quot;Job with dbID=&#39;$job_id&#39; is $job_status, please use -force 1 to override&quot;</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        $analysis = $job-&gt;analysis;</div>
<div class="line">        <span class="keywordflow">if</span>(($analysis-&gt;stats-&gt;status eq <span class="stringliteral">&#39;BLOCKED&#39;</span>) and !$force) {</div>
<div class="line">            die <span class="stringliteral">&quot;Analysis is BLOCKED, can&#39;t specialize a worker. Please use -force 1 to override&quot;</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(($job_status eq <span class="stringliteral">&#39;DONE&#39;</span>) and $job-&gt;semaphored_job_id) {</div>
<div class="line">            warn <span class="stringliteral">&quot;Increasing the semaphore count of the dependent job&quot;</span>;</div>
<div class="line">            $job_adaptor-&gt;increase_semaphore_count_for_jobid( $job-&gt;semaphored_job_id );</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line"></div>
<div class="line">        $analyses_pattern <span class="comment">//= &#39;%&#39;;  # for printing</span></div>
<div class="line">        my $analyses_matching_pattern   = $self-&gt;db-&gt;hive_pipeline-&gt;collection_of( <span class="stringliteral">&#39;Analysis&#39;</span> )-&gt;find_all_by_pattern( $analyses_pattern );</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">            # refresh the stats of matching analyses before re-specialization:</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">foreach</span> my $analysis ( @$analyses_matching_pattern ) {</div>
<div class="line">            $analysis-&gt;stats-&gt;refresh();</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        $analysis = <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_scheduler.html#a9d2af12ce052ca879c543465c6477da1">Bio::EnsEMBL::Hive::Scheduler::suggest_analysis_to_specialize_a_worker</a>($worker, $analyses_matching_pattern, $analyses_pattern);</div>
<div class="line"></div>
<div class="line">        unless( ref($analysis) ) {</div>
<div class="line"></div>
<div class="line">            $worker-&gt;cause_of_death(<span class="stringliteral">&#39;NO_ROLE&#39;</span>);</div>
<div class="line"></div>
<div class="line">            my $msg = $analysis <span class="comment">// &quot;No analysis suitable for the worker was found&quot;;</span></div>
<div class="line">            die <span class="stringliteral">&quot;$msg\n&quot;</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my $new_role = <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_role.html">Bio::EnsEMBL::Hive::Role</a>-&gt;<a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_storable.html#a52efcf0d0755525a7bc059b68442c620">new</a>(</div>
<div class="line">        <span class="stringliteral">&#39;worker&#39;</span>        =&gt; $worker,</div>
<div class="line">        <span class="stringliteral">&#39;analysis&#39;</span>      =&gt; $analysis,</div>
<div class="line">    );</div>
<div class="line">    $self-&gt;db-&gt;get_RoleAdaptor-&gt;store( $new_role );</div>
<div class="line">    $worker-&gt;current_role( $new_role );</div>
<div class="line"></div>
<div class="line">    my $analysis_stats_adaptor = $self-&gt;db-&gt;get_AnalysisStatsAdaptor;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>($job_id) {</div>
<div class="line">        my $role_id = $new_role-&gt;<a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_storable.html#a5e5743dee1414d2c0dec45b5a5d42216">dbID</a>;</div>
<div class="line">        <span class="keywordflow">if</span>( my $job = $self-&gt;db-&gt;get_AnalysisJobAdaptor-&gt;reset_or_grab_job_by_dbID($job_id, $role_id) ) {</div>
<div class="line"></div>
<div class="line">            $worker-&gt;special_batch( [ $job ] );</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            die <span class="stringliteral">&quot;Could not claim job with dbID=&#39;$job_id&#39; for Role with dbID=&#39;$role_id&#39;&quot;</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">    } <span class="keywordflow">else</span> {    # Note: special batch Workers should avoid flipping the status to <span class="stringliteral">&#39;WORKING&#39;</span> in <span class="keywordflow">case</span> the analysis is still <span class="stringliteral">&#39;BLOCKED&#39;</span></div>
<div class="line"></div>
<div class="line">        $analysis_stats_adaptor-&gt;update_status($analysis-&gt;dbID, <span class="stringliteral">&#39;WORKING&#39;</span>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        # The following increment used to be done only when no specific task was given to the worker,</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        # thereby excluding such &quot;special task&quot; workers from being counted in num_running_workers.</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        # However this may be tricky to emulate by triggers that know nothing about &quot;special tasks&quot;,</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        # so I am (temporarily?) simplifying the accounting algorithm.</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #</span></div>
<div class="line"><span class="preprocessor"></span>    $analysis_stats_adaptor-&gt;increment_a_counter( <span class="stringliteral">&#39;num_running_workers&#39;</span>, 1, $analysis-&gt;dbID );</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="aa267d5c9af7b860bca670e2561de4fd2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::Queen::store_resource_usage </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented method</p>
<div id="codesection-store_resource_usage" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-store_resource_usage-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-store_resource_usage-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-store_resource_usage-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#aa267d5c9af7b860bca670e2561de4fd2">store_resource_usage</a> {</div>
<div class="line">    my ($self, $report_entries, $processid_2_workerid) = @_;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    # FIXME: An UPSERT would be better here, but it is only promised in PostgreSQL starting from 9.5, which is not officially out yet.</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">    my $sql_delete = <span class="stringliteral">&#39;DELETE FROM worker_resource_usage WHERE worker_id=?&#39;</span>;</div>
<div class="line">    my $sth_delete = $self-&gt;prepare( $sql_delete );</div>
<div class="line"></div>
<div class="line">    my $sql_insert = <span class="stringliteral">&#39;INSERT INTO worker_resource_usage (worker_id, exit_status, mem_megs, swap_megs, pending_sec, cpu_sec, lifespan_sec, exception_status) VALUES (?, ?, ?, ?, ?, ?, ?, ?)&#39;</span>;</div>
<div class="line">    my $sth_insert = $self-&gt;prepare( $sql_insert );</div>
<div class="line"></div>
<div class="line">    my @not_ours = ();</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span>( my ($process_id, $report_entry) = each %$report_entries ) {</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>( my $worker_id = $processid_2_workerid-&gt;{$process_id} ) {</div>
<div class="line">            $sth_delete-&gt;execute( $worker_id );</div>
<div class="line"></div>
<div class="line">            eval {</div>
<div class="line">                $sth_insert-&gt;execute( $worker_id, @$report_entry{<span class="stringliteral">&#39;exit_status&#39;</span>, <span class="stringliteral">&#39;mem_megs&#39;</span>, <span class="stringliteral">&#39;swap_megs&#39;</span>, <span class="stringliteral">&#39;pending_sec&#39;</span>, <span class="stringliteral">&#39;cpu_sec&#39;</span>, <span class="stringliteral">&#39;lifespan_sec&#39;</span>, <span class="stringliteral">&#39;exception_status&#39;</span>} );  # slicing hashref</div>
<div class="line">                1;</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="a3dc0b403e92e34e2b7e01467a05dd156"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::Queen::synchronize_AnalysisStats </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre>
  Arg [1]    : <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_analysis_stats.html">Bio::EnsEMBL::Hive::AnalysisStats</a> object
  Example    :</pre><div class="fragment"><div class="line">$self-&gt;synchronize_AnalysisStats( $stats );</div>
</div><!-- fragment --> <pre>  Description: Queries the job and worker tables to get summary counts
               and rebuilds the <a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_analysis_stats.html">AnalysisStats</a> object.
               Then updates the analysis_stats table with the new summary info.
  Exceptions : none
  Caller     : general</pre><pre> </pre><div id="codesection-synchronize_AnalysisStats" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-synchronize_AnalysisStats-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-synchronize_AnalysisStats-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-synchronize_AnalysisStats-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#a3dc0b403e92e34e2b7e01467a05dd156">synchronize_AnalysisStats</a> {</div>
<div class="line">    my ($self, $stats) = @_;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>( $stats and $stats-&gt;analysis_id ) {</div>
<div class="line"></div>
<div class="line">        $stats-&gt;refresh(); ## Need to <span class="keyword">get</span> the <span class="keyword">new</span> hive_capacity <span class="keywordflow">for</span> dynamic analyses</div>
<div class="line"></div>
<div class="line">        my $job_counts = $stats-&gt;hive_pipeline-&gt;hive_use_triggers() ? undef : $self-&gt;db-&gt;get_AnalysisJobAdaptor-&gt;fetch_job_counts_hashed_by_status( $stats-&gt;analysis_id );</div>
<div class="line"></div>
<div class="line">        $stats-&gt;recalculate_from_job_counts( $job_counts );</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        # $stats-&gt;sync_lock(0); ## do we perhaps need it here?</span></div>
<div class="line"><span class="preprocessor"></span>        $stats-&gt;update;  #<a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_d_b_s_q_l_1_1_base_adaptor.html#ab8f4cc3813b7d1ad259b02e4a24112f2">update</a> and release sync_lock</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<a class="anchor" id="a2892c256744ac4bdd4f90b9bcc238735"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public Bio::EnsEMBL::Hive::Queen::synchronize_hive </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre>
  Arg [1]    : $list_of_analyses
  Example    :</pre><div class="fragment"><div class="line">$queen-&gt;synchronize_hive( [ $analysis_A, $analysis_B ] );</div>
</div><!-- fragment --> <pre>  Description: Runs through all analyses in the given list and synchronizes
              the analysis_stats summary with the states in the job and worker tables.
              Then follows by checking all the blocking rules and blocks/unblocks analyses as needed.
  Exceptions : none
  Caller     : general</pre><pre> </pre><div id="codesection-synchronize_hive" class="dynheader closed" style="cursor:pointer;" onclick="return toggleVisibility(this)">  
    <img id='codesection-synchronize_hive-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-synchronize_hive-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-synchronize_hive-content' class='dyncontent' style='display: none;'> 
 <div class="fragment"><div class="line">sub <a class="code" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html#a2892c256744ac4bdd4f90b9bcc238735">synchronize_hive</a> {</div>
<div class="line">    my ($self, $list_of_analyses) = @_;</div>
<div class="line"></div>
<div class="line">    my $start_time = time();</div>
<div class="line"></div>
<div class="line">    print STDERR <span class="stringliteral">&quot;\nSynchronizing the hive (&quot;</span>.scalar(@$list_of_analyses).<span class="stringliteral">&quot; analyses this time):\n&quot;</span>;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $analysis (@$list_of_analyses) {</div>
<div class="line">        $self-&gt;synchronize_AnalysisStats($analysis-&gt;stats);</div>
<div class="line">        print STDERR ( ($analysis-&gt;stats()-&gt;status eq <span class="stringliteral">&#39;BLOCKED&#39;</span>) ? <span class="charliteral">&#39;x&#39;</span> : <span class="charliteral">&#39;o&#39;</span>);</div>
<div class="line">    }</div>
<div class="line">    print STDERR <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    print STDERR <span class="stringliteral">&#39;&#39;</span>.((time() - $start_time)).<span class="stringliteral">&quot; seconds to synchronize_hive\n\n&quot;</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> </div> 
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>modules/Bio/EnsEMBL/Hive/<a class="el" href="_queen_8pm.html">Queen.pm</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespace_bio.html">Bio</a></li><li class="navelem"><a class="el" href="namespace_bio_1_1_ens_e_m_b_l.html">EnsEMBL</a></li><li class="navelem"><a class="el" href="namespace_bio_1_1_ens_e_m_b_l_1_1_hive.html">Hive</a></li><li class="navelem"><a class="el" href="class_bio_1_1_ens_e_m_b_l_1_1_hive_1_1_queen.html">Queen</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
